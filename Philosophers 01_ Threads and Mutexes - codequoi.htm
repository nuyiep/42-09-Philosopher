<!DOCTYPE html>
<!-- saved from url=(0107)https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/ -->
<html lang="en-US" class="js no-svg"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" async="" src="./Philosophers 01_ Threads and Mutexes - codequoi_files/matomo.js"></script><script src="./Philosophers 01_ Threads and Mutexes - codequoi_files/analytics.js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app214.us.archive.org';v.server_ms=414;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="./Philosophers 01_ Threads and Mutexes - codequoi_files/bundle-playback.js" charset="utf-8"></script>
<script type="text/javascript" src="./Philosophers 01_ Threads and Mutexes - codequoi_files/wombat.js" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/","20220718211836","https://web.archive.org/","web","/_static/",
	      "1658179116");
</script>
<link rel="stylesheet" type="text/css" href="./Philosophers 01_ Threads and Mutexes - codequoi_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="./Philosophers 01_ Threads and Mutexes - codequoi_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->

		
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="profile" href="http://gmpg.org/xfn/11">
		<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<link rel="alternate" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/" hreflang="en">
<link rel="alternate" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/philosophers-01-threads-et-mutex/" hreflang="fr">

	<!-- This site is optimized with the Yoast SEO plugin v19.3 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Philosophers 01: Threads and Mutexes - codequoi</title>
	<meta name="description" content="The 42 project philosophers explores concurrent programming with threads and mutexes. Let&#39;s learn how to deal with data races and deadlocks.">
	<link rel="canonical" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/">
	<meta property="og:locale" content="en_US">
	<meta property="og:locale:alternate" content="fr_FR">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Philosophers 01: Threads and Mutexes - codequoi">
	<meta property="og:description" content="The 42 project philosophers explores concurrent programming with threads and mutexes. Let&#39;s learn how to deal with data races and deadlocks.">
	<meta property="og:url" content="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/">
	<meta property="og:site_name" content="codequoi">
	<meta property="article:published_time" content="2022-07-18T15:17:16+00:00">
	<meta property="article:modified_time" content="2022-07-18T15:39:10+00:00">
	<meta property="og:image" content="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers.png">
	<meta property="og:image:width" content="1200">
	<meta property="og:image:height" content="1200">
	<meta property="og:image:type" content="image/png">
	<meta name="author" content="Mia Combeau">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:image" content="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers.png">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Mia Combeau">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="48 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://web.archive.org/web/20220718211836/https://schema.org","@graph":[{"@type":"Organization","@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/#organization","name":"code(quoi);","url":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/","sameAs":[],"logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/#/schema/logo/image/","url":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2021/12/Codequoi.jpg","contentUrl":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2021/12/Codequoi.jpg","width":1920,"height":1080,"caption":"code(quoi);"},"image":{"@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/#/schema/logo/image/"}},{"@type":"WebSite","@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/#website","url":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/","name":"codequoi","description":"So, what should we code?","publisher":{"@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#primaryimage","url":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers.png","contentUrl":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers.png","width":1200,"height":1200},{"@type":"WebPage","@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/","url":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/","name":"Philosophers 01: Threads and Mutexes - codequoi","isPartOf":{"@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/#website"},"primaryImageOfPage":{"@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#primaryimage"},"datePublished":"2022-07-18T15:17:16+00:00","dateModified":"2022-07-18T15:39:10+00:00","description":"The 42 project philosophers explores concurrent programming with threads and mutexes. Let's learn how to deal with data races and deadlocks.","breadcrumb":{"@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/"]}]},{"@type":"BreadcrumbList","@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/"},{"@type":"ListItem","position":2,"name":"Philosophers 01: Threads and Mutexes"}]},{"@type":"Article","@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#article","isPartOf":{"@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/"},"author":{"name":"Mia Combeau","@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/#/schema/person/c6d9501cd1677018f97ef4fcaf35c5ce"},"headline":"Philosophers 01: Threads and Mutexes","datePublished":"2022-07-18T15:17:16+00:00","dateModified":"2022-07-18T15:39:10+00:00","mainEntityOfPage":{"@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/"},"wordCount":7078,"commentCount":0,"publisher":{"@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/#organization"},"image":{"@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#primaryimage"},"thumbnailUrl":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers.png","keywords":["42 cursus","C","concurrency","data race","deadlock","mutex","thread"],"articleSection":["42 School Projects"],"inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#respond"]}]},{"@type":"Person","@id":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/#/schema/person/c6d9501cd1677018f97ef4fcaf35c5ce","name":"Mia Combeau","description":"Student at 42Paris, digital world explorer. I code to the 42 school norm, which means for loops, switches, ternary operators and all kinds of other things are out of reach... for now!","sameAs":["https://web.archive.org/web/20220718211836/https://www.codequoi.com"],"url":"https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/author/mcombeau/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://web.archive.org/web/20220718211836/https://fonts.googleapis.com/">
<link href="https://web.archive.org/web/20220718211836/https://fonts.gstatic.com/" crossorigin="" rel="preconnect">
<link rel="preconnect" href="https://web.archive.org/web/20220718211836/https://fonts.googleapis.com/">
<link rel="alternate" type="application/rss+xml" title="codequoi » Feed" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/feed/">
<link rel="alternate" type="application/rss+xml" title="codequoi » Comments Feed" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="codequoi » Philosophers 01: Threads and Mutexes Comments Feed" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/feed/">
<link rel="stylesheet" id="wp-block-library-css" href="./Philosophers 01_ Threads and Mutexes - codequoi_files/style.min.css" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--typology-acc: #41c2a6;--wp--preset--color--typology-txt: #444444;--wp--preset--color--typology-meta: #888888;--wp--preset--color--typology-bg: #ffffff;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('/web/20220718211836im_/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('/web/20220718211836im_/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('/web/20220718211836im_/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('/web/20220718211836im_/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('/web/20220718211836im_/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('/web/20220718211836im_/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('/web/20220718211836im_/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('/web/20220718211836im_/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#wp-duotone-blue-orange');--wp--preset--font-size--small: 12.8px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 22.4px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 16px;--wp--preset--font-size--huge: 28.8px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<style id="extendify-gutenberg-patterns-and-templates-utilities-inline-css" type="text/css">
.ext-absolute{position:absolute!important}.ext-relative{position:relative!important}.ext-top-base{top:var(--wp--style--block-gap,1.75rem)!important}.ext-top-lg{top:var(--extendify--spacing--large,3rem)!important}.ext--top-base{top:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--top-lg{top:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-right-base{right:var(--wp--style--block-gap,1.75rem)!important}.ext-right-lg{right:var(--extendify--spacing--large,3rem)!important}.ext--right-base{right:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--right-lg{right:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-bottom-base{bottom:var(--wp--style--block-gap,1.75rem)!important}.ext-bottom-lg{bottom:var(--extendify--spacing--large,3rem)!important}.ext--bottom-base{bottom:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--bottom-lg{bottom:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-left-base{left:var(--wp--style--block-gap,1.75rem)!important}.ext-left-lg{left:var(--extendify--spacing--large,3rem)!important}.ext--left-base{left:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--left-lg{left:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-order-1{order:1!important}.ext-order-2{order:2!important}.ext-col-auto{grid-column:auto!important}.ext-col-span-1{grid-column:span 1/span 1!important}.ext-col-span-2{grid-column:span 2/span 2!important}.ext-col-span-3{grid-column:span 3/span 3!important}.ext-col-span-4{grid-column:span 4/span 4!important}.ext-col-span-5{grid-column:span 5/span 5!important}.ext-col-span-6{grid-column:span 6/span 6!important}.ext-col-span-7{grid-column:span 7/span 7!important}.ext-col-span-8{grid-column:span 8/span 8!important}.ext-col-span-9{grid-column:span 9/span 9!important}.ext-col-span-10{grid-column:span 10/span 10!important}.ext-col-span-11{grid-column:span 11/span 11!important}.ext-col-span-12{grid-column:span 12/span 12!important}.ext-col-span-full{grid-column:1/-1!important}.ext-col-start-1{grid-column-start:1!important}.ext-col-start-2{grid-column-start:2!important}.ext-col-start-3{grid-column-start:3!important}.ext-col-start-4{grid-column-start:4!important}.ext-col-start-5{grid-column-start:5!important}.ext-col-start-6{grid-column-start:6!important}.ext-col-start-7{grid-column-start:7!important}.ext-col-start-8{grid-column-start:8!important}.ext-col-start-9{grid-column-start:9!important}.ext-col-start-10{grid-column-start:10!important}.ext-col-start-11{grid-column-start:11!important}.ext-col-start-12{grid-column-start:12!important}.ext-col-start-13{grid-column-start:13!important}.ext-col-start-auto{grid-column-start:auto!important}.ext-col-end-1{grid-column-end:1!important}.ext-col-end-2{grid-column-end:2!important}.ext-col-end-3{grid-column-end:3!important}.ext-col-end-4{grid-column-end:4!important}.ext-col-end-5{grid-column-end:5!important}.ext-col-end-6{grid-column-end:6!important}.ext-col-end-7{grid-column-end:7!important}.ext-col-end-8{grid-column-end:8!important}.ext-col-end-9{grid-column-end:9!important}.ext-col-end-10{grid-column-end:10!important}.ext-col-end-11{grid-column-end:11!important}.ext-col-end-12{grid-column-end:12!important}.ext-col-end-13{grid-column-end:13!important}.ext-col-end-auto{grid-column-end:auto!important}.ext-row-auto{grid-row:auto!important}.ext-row-span-1{grid-row:span 1/span 1!important}.ext-row-span-2{grid-row:span 2/span 2!important}.ext-row-span-3{grid-row:span 3/span 3!important}.ext-row-span-4{grid-row:span 4/span 4!important}.ext-row-span-5{grid-row:span 5/span 5!important}.ext-row-span-6{grid-row:span 6/span 6!important}.ext-row-span-full{grid-row:1/-1!important}.ext-row-start-1{grid-row-start:1!important}.ext-row-start-2{grid-row-start:2!important}.ext-row-start-3{grid-row-start:3!important}.ext-row-start-4{grid-row-start:4!important}.ext-row-start-5{grid-row-start:5!important}.ext-row-start-6{grid-row-start:6!important}.ext-row-start-7{grid-row-start:7!important}.ext-row-start-auto{grid-row-start:auto!important}.ext-row-end-1{grid-row-end:1!important}.ext-row-end-2{grid-row-end:2!important}.ext-row-end-3{grid-row-end:3!important}.ext-row-end-4{grid-row-end:4!important}.ext-row-end-5{grid-row-end:5!important}.ext-row-end-6{grid-row-end:6!important}.ext-row-end-7{grid-row-end:7!important}.ext-row-end-auto{grid-row-end:auto!important}.ext-m-0:not([style*=margin]){margin:0!important}.ext-m-auto:not([style*=margin]){margin:auto!important}.ext-m-base:not([style*=margin]){margin:var(--wp--style--block-gap,1.75rem)!important}.ext-m-lg:not([style*=margin]){margin:var(--extendify--spacing--large,3rem)!important}.ext--m-base:not([style*=margin]){margin:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--m-lg:not([style*=margin]){margin:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-mx-0:not([style*=margin]){margin-left:0!important;margin-right:0!important}.ext-mx-auto:not([style*=margin]){margin-left:auto!important;margin-right:auto!important}.ext-mx-base:not([style*=margin]){margin-left:var(--wp--style--block-gap,1.75rem)!important;margin-right:var(--wp--style--block-gap,1.75rem)!important}.ext-mx-lg:not([style*=margin]){margin-left:var(--extendify--spacing--large,3rem)!important;margin-right:var(--extendify--spacing--large,3rem)!important}.ext--mx-base:not([style*=margin]){margin-left:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important;margin-right:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--mx-lg:not([style*=margin]){margin-left:calc(var(--extendify--spacing--large, 3rem)*-1)!important;margin-right:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-my-0:not([style*=margin]){margin-bottom:0!important;margin-top:0!important}.ext-my-auto:not([style*=margin]){margin-bottom:auto!important;margin-top:auto!important}.ext-my-base:not([style*=margin]){margin-bottom:var(--wp--style--block-gap,1.75rem)!important;margin-top:var(--wp--style--block-gap,1.75rem)!important}.ext-my-lg:not([style*=margin]){margin-bottom:var(--extendify--spacing--large,3rem)!important;margin-top:var(--extendify--spacing--large,3rem)!important}.ext--my-base:not([style*=margin]){margin-bottom:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important;margin-top:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--my-lg:not([style*=margin]){margin-bottom:calc(var(--extendify--spacing--large, 3rem)*-1)!important;margin-top:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-mt-0:not([style*=margin]){margin-top:0!important}.ext-mt-auto:not([style*=margin]){margin-top:auto!important}.ext-mt-base:not([style*=margin]){margin-top:var(--wp--style--block-gap,1.75rem)!important}.ext-mt-lg:not([style*=margin]){margin-top:var(--extendify--spacing--large,3rem)!important}.ext--mt-base:not([style*=margin]){margin-top:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--mt-lg:not([style*=margin]){margin-top:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-mr-0:not([style*=margin]){margin-right:0!important}.ext-mr-auto:not([style*=margin]){margin-right:auto!important}.ext-mr-base:not([style*=margin]){margin-right:var(--wp--style--block-gap,1.75rem)!important}.ext-mr-lg:not([style*=margin]){margin-right:var(--extendify--spacing--large,3rem)!important}.ext--mr-base:not([style*=margin]){margin-right:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--mr-lg:not([style*=margin]){margin-right:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-mb-0:not([style*=margin]){margin-bottom:0!important}.ext-mb-auto:not([style*=margin]){margin-bottom:auto!important}.ext-mb-base:not([style*=margin]){margin-bottom:var(--wp--style--block-gap,1.75rem)!important}.ext-mb-lg:not([style*=margin]){margin-bottom:var(--extendify--spacing--large,3rem)!important}.ext--mb-base:not([style*=margin]){margin-bottom:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--mb-lg:not([style*=margin]){margin-bottom:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-ml-0:not([style*=margin]){margin-left:0!important}.ext-ml-auto:not([style*=margin]){margin-left:auto!important}.ext-ml-base:not([style*=margin]){margin-left:var(--wp--style--block-gap,1.75rem)!important}.ext-ml-lg:not([style*=margin]){margin-left:var(--extendify--spacing--large,3rem)!important}.ext--ml-base:not([style*=margin]){margin-left:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.ext--ml-lg:not([style*=margin]){margin-left:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.ext-block{display:block!important}.ext-inline-block{display:inline-block!important}.ext-inline{display:inline!important}.ext-flex{display:flex!important}.ext-inline-flex{display:inline-flex!important}.ext-grid{display:grid!important}.ext-inline-grid{display:inline-grid!important}.ext-hidden{display:none!important}.ext-w-auto{width:auto!important}.ext-w-full{width:100%!important}.ext-max-w-full{max-width:100%!important}.ext-flex-1{flex:1 1 0%!important}.ext-flex-auto{flex:1 1 auto!important}.ext-flex-initial{flex:0 1 auto!important}.ext-flex-none{flex:none!important}.ext-flex-shrink-0{flex-shrink:0!important}.ext-flex-shrink{flex-shrink:1!important}.ext-flex-grow-0{flex-grow:0!important}.ext-flex-grow{flex-grow:1!important}.ext-list-none{list-style-type:none!important}.ext-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))!important}.ext-grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))!important}.ext-grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))!important}.ext-grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))!important}.ext-grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))!important}.ext-grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))!important}.ext-grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))!important}.ext-grid-cols-8{grid-template-columns:repeat(8,minmax(0,1fr))!important}.ext-grid-cols-9{grid-template-columns:repeat(9,minmax(0,1fr))!important}.ext-grid-cols-10{grid-template-columns:repeat(10,minmax(0,1fr))!important}.ext-grid-cols-11{grid-template-columns:repeat(11,minmax(0,1fr))!important}.ext-grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))!important}.ext-grid-cols-none{grid-template-columns:none!important}.ext-grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))!important}.ext-grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))!important}.ext-grid-rows-3{grid-template-rows:repeat(3,minmax(0,1fr))!important}.ext-grid-rows-4{grid-template-rows:repeat(4,minmax(0,1fr))!important}.ext-grid-rows-5{grid-template-rows:repeat(5,minmax(0,1fr))!important}.ext-grid-rows-6{grid-template-rows:repeat(6,minmax(0,1fr))!important}.ext-grid-rows-none{grid-template-rows:none!important}.ext-flex-row{flex-direction:row!important}.ext-flex-row-reverse{flex-direction:row-reverse!important}.ext-flex-col{flex-direction:column!important}.ext-flex-col-reverse{flex-direction:column-reverse!important}.ext-flex-wrap{flex-wrap:wrap!important}.ext-flex-wrap-reverse{flex-wrap:wrap-reverse!important}.ext-flex-nowrap{flex-wrap:nowrap!important}.ext-items-start{align-items:flex-start!important}.ext-items-end{align-items:flex-end!important}.ext-items-center{align-items:center!important}.ext-items-baseline{align-items:baseline!important}.ext-items-stretch{align-items:stretch!important}.ext-justify-start{justify-content:flex-start!important}.ext-justify-end{justify-content:flex-end!important}.ext-justify-center{justify-content:center!important}.ext-justify-between{justify-content:space-between!important}.ext-justify-around{justify-content:space-around!important}.ext-justify-evenly{justify-content:space-evenly!important}.ext-justify-items-start{justify-items:start!important}.ext-justify-items-end{justify-items:end!important}.ext-justify-items-center{justify-items:center!important}.ext-justify-items-stretch{justify-items:stretch!important}.ext-gap-0{gap:0!important}.ext-gap-base{gap:var(--wp--style--block-gap,1.75rem)!important}.ext-gap-lg{gap:var(--extendify--spacing--large,3rem)!important}.ext-gap-x-0{-moz-column-gap:0!important;column-gap:0!important}.ext-gap-x-base{-moz-column-gap:var(--wp--style--block-gap,1.75rem)!important;column-gap:var(--wp--style--block-gap,1.75rem)!important}.ext-gap-x-lg{-moz-column-gap:var(--extendify--spacing--large,3rem)!important;column-gap:var(--extendify--spacing--large,3rem)!important}.ext-gap-y-0{row-gap:0!important}.ext-gap-y-base{row-gap:var(--wp--style--block-gap,1.75rem)!important}.ext-gap-y-lg{row-gap:var(--extendify--spacing--large,3rem)!important}.ext-justify-self-auto{justify-self:auto!important}.ext-justify-self-start{justify-self:start!important}.ext-justify-self-end{justify-self:end!important}.ext-justify-self-center{justify-self:center!important}.ext-justify-self-stretch{justify-self:stretch!important}.ext-rounded-none{border-radius:0!important}.ext-rounded-full{border-radius:9999px!important}.ext-rounded-t-none{border-top-left-radius:0!important;border-top-right-radius:0!important}.ext-rounded-t-full{border-top-left-radius:9999px!important;border-top-right-radius:9999px!important}.ext-rounded-r-none{border-bottom-right-radius:0!important;border-top-right-radius:0!important}.ext-rounded-r-full{border-bottom-right-radius:9999px!important;border-top-right-radius:9999px!important}.ext-rounded-b-none{border-bottom-left-radius:0!important;border-bottom-right-radius:0!important}.ext-rounded-b-full{border-bottom-left-radius:9999px!important;border-bottom-right-radius:9999px!important}.ext-rounded-l-none{border-bottom-left-radius:0!important;border-top-left-radius:0!important}.ext-rounded-l-full{border-bottom-left-radius:9999px!important;border-top-left-radius:9999px!important}.ext-rounded-tl-none{border-top-left-radius:0!important}.ext-rounded-tl-full{border-top-left-radius:9999px!important}.ext-rounded-tr-none{border-top-right-radius:0!important}.ext-rounded-tr-full{border-top-right-radius:9999px!important}.ext-rounded-br-none{border-bottom-right-radius:0!important}.ext-rounded-br-full{border-bottom-right-radius:9999px!important}.ext-rounded-bl-none{border-bottom-left-radius:0!important}.ext-rounded-bl-full{border-bottom-left-radius:9999px!important}.ext-border-0{border-width:0!important}.ext-border-t-0{border-top-width:0!important}.ext-border-r-0{border-right-width:0!important}.ext-border-b-0{border-bottom-width:0!important}.ext-border-l-0{border-left-width:0!important}.ext-p-0:not([style*=padding]){padding:0!important}.ext-p-base:not([style*=padding]){padding:var(--wp--style--block-gap,1.75rem)!important}.ext-p-lg:not([style*=padding]){padding:var(--extendify--spacing--large,3rem)!important}.ext-px-0:not([style*=padding]){padding-left:0!important;padding-right:0!important}.ext-px-base:not([style*=padding]){padding-left:var(--wp--style--block-gap,1.75rem)!important;padding-right:var(--wp--style--block-gap,1.75rem)!important}.ext-px-lg:not([style*=padding]){padding-left:var(--extendify--spacing--large,3rem)!important;padding-right:var(--extendify--spacing--large,3rem)!important}.ext-py-0:not([style*=padding]){padding-bottom:0!important;padding-top:0!important}.ext-py-base:not([style*=padding]){padding-bottom:var(--wp--style--block-gap,1.75rem)!important;padding-top:var(--wp--style--block-gap,1.75rem)!important}.ext-py-lg:not([style*=padding]){padding-bottom:var(--extendify--spacing--large,3rem)!important;padding-top:var(--extendify--spacing--large,3rem)!important}.ext-pt-0:not([style*=padding]){padding-top:0!important}.ext-pt-base:not([style*=padding]){padding-top:var(--wp--style--block-gap,1.75rem)!important}.ext-pt-lg:not([style*=padding]){padding-top:var(--extendify--spacing--large,3rem)!important}.ext-pr-0:not([style*=padding]){padding-right:0!important}.ext-pr-base:not([style*=padding]){padding-right:var(--wp--style--block-gap,1.75rem)!important}.ext-pr-lg:not([style*=padding]){padding-right:var(--extendify--spacing--large,3rem)!important}.ext-pb-0:not([style*=padding]){padding-bottom:0!important}.ext-pb-base:not([style*=padding]){padding-bottom:var(--wp--style--block-gap,1.75rem)!important}.ext-pb-lg:not([style*=padding]){padding-bottom:var(--extendify--spacing--large,3rem)!important}.ext-pl-0:not([style*=padding]){padding-left:0!important}.ext-pl-base:not([style*=padding]){padding-left:var(--wp--style--block-gap,1.75rem)!important}.ext-pl-lg:not([style*=padding]){padding-left:var(--extendify--spacing--large,3rem)!important}.ext-text-left{text-align:left!important}.ext-text-center{text-align:center!important}.ext-text-right{text-align:right!important}.ext-leading-none{line-height:1!important}.ext-leading-tight{line-height:1.25!important}.ext-leading-snug{line-height:1.375!important}.ext-leading-normal{line-height:1.5!important}.ext-leading-relaxed{line-height:1.625!important}.ext-leading-loose{line-height:2!important}.clip-path--rhombus img{-webkit-clip-path:polygon(15% 6%,80% 29%,84% 93%,23% 69%);clip-path:polygon(15% 6%,80% 29%,84% 93%,23% 69%)}.clip-path--diamond img{-webkit-clip-path:polygon(5% 29%,60% 2%,91% 64%,36% 89%);clip-path:polygon(5% 29%,60% 2%,91% 64%,36% 89%)}.clip-path--rhombus-alt img{-webkit-clip-path:polygon(14% 9%,85% 24%,91% 89%,19% 76%);clip-path:polygon(14% 9%,85% 24%,91% 89%,19% 76%)}.wp-block-columns[class*=fullwidth-cols]{margin-bottom:unset}.wp-block-column.editor\:pointer-events-none{margin-bottom:0!important;margin-top:0!important}.is-root-container.block-editor-block-list__layout>[data-align=full]:not(:first-of-type)>.wp-block-column.editor\:pointer-events-none,.is-root-container.block-editor-block-list__layout>[data-align=wide]>.wp-block-column.editor\:pointer-events-none{margin-top:calc(var(--wp--style--block-gap, 28px)*-1)!important}.ext .wp-block-columns .wp-block-column[style*=padding]{padding-left:0!important;padding-right:0!important}.ext .wp-block-columns+.wp-block-columns:not([class*=mt-]):not([class*=my-]):not([style*=margin]){margin-top:0!important}[class*=fullwidth-cols] .wp-block-column:first-child,[class*=fullwidth-cols] .wp-block-group:first-child{margin-top:0}[class*=fullwidth-cols] .wp-block-column:last-child,[class*=fullwidth-cols] .wp-block-group:last-child{margin-bottom:0}[class*=fullwidth-cols] .wp-block-column:first-child>*,[class*=fullwidth-cols] .wp-block-column>:first-child{margin-top:0}.ext .is-not-stacked-on-mobile .wp-block-column,[class*=fullwidth-cols] .wp-block-column>:last-child{margin-bottom:0}.wp-block-columns[class*=fullwidth-cols]:not(.is-not-stacked-on-mobile)>.wp-block-column:not(:last-child){margin-bottom:var(--wp--style--block-gap,1.75rem)}@media (min-width:782px){.wp-block-columns[class*=fullwidth-cols]:not(.is-not-stacked-on-mobile)>.wp-block-column:not(:last-child){margin-bottom:0}}.wp-block-columns[class*=fullwidth-cols].is-not-stacked-on-mobile>.wp-block-column{margin-bottom:0!important}@media (min-width:600px) and (max-width:781px){.wp-block-columns[class*=fullwidth-cols]:not(.is-not-stacked-on-mobile)>.wp-block-column:nth-child(2n){margin-left:var(--wp--style--block-gap,2em)}}@media (max-width:781px){.tablet\:fullwidth-cols.wp-block-columns:not(.is-not-stacked-on-mobile){flex-wrap:wrap}.tablet\:fullwidth-cols.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column,.tablet\:fullwidth-cols.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column:not([style*=margin]){margin-left:0!important}.tablet\:fullwidth-cols.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column{flex-basis:100%!important}}@media (max-width:1079px){.desktop\:fullwidth-cols.wp-block-columns:not(.is-not-stacked-on-mobile){flex-wrap:wrap}.desktop\:fullwidth-cols.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column,.desktop\:fullwidth-cols.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column:not([style*=margin]){margin-left:0!important}.desktop\:fullwidth-cols.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column{flex-basis:100%!important}.desktop\:fullwidth-cols.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column:not(:last-child){margin-bottom:var(--wp--style--block-gap,1.75rem)!important}}.direction-rtl{direction:rtl}.direction-ltr{direction:ltr}.is-style-inline-list{padding-left:0!important}.is-style-inline-list li{list-style-type:none!important}@media (min-width:782px){.is-style-inline-list li{display:inline!important;margin-right:var(--wp--style--block-gap,1.75rem)!important}}@media (min-width:782px){.is-style-inline-list li:first-child{margin-left:0!important}}@media (min-width:782px){.is-style-inline-list li:last-child{margin-right:0!important}}.bring-to-front{position:relative;z-index:10}.text-stroke{-webkit-text-stroke-color:var(--wp--preset--color--background)}.text-stroke,.text-stroke--primary{-webkit-text-stroke-width:var(
        --wp--custom--typography--text-stroke-width,2px
    )}.text-stroke--primary{-webkit-text-stroke-color:var(--wp--preset--color--primary)}.text-stroke--secondary{-webkit-text-stroke-width:var(
        --wp--custom--typography--text-stroke-width,2px
    );-webkit-text-stroke-color:var(--wp--preset--color--secondary)}.editor\:no-caption .block-editor-rich-text__editable{display:none!important}.editor\:no-inserter .wp-block-column:not(.is-selected)>.block-list-appender,.editor\:no-inserter .wp-block-cover__inner-container>.block-list-appender,.editor\:no-inserter .wp-block-group__inner-container>.block-list-appender,.editor\:no-inserter>.block-list-appender{display:none}.editor\:no-resize .components-resizable-box__handle,.editor\:no-resize .components-resizable-box__handle:after,.editor\:no-resize .components-resizable-box__side-handle:before{display:none;pointer-events:none}.editor\:no-resize .components-resizable-box__container{display:block}.editor\:pointer-events-none{pointer-events:none}.is-style-angled{justify-content:flex-end}.ext .is-style-angled>[class*=_inner-container],.is-style-angled{align-items:center}.is-style-angled .wp-block-cover__image-background,.is-style-angled .wp-block-cover__video-background{-webkit-clip-path:polygon(0 0,30% 0,50% 100%,0 100%);clip-path:polygon(0 0,30% 0,50% 100%,0 100%);z-index:1}@media (min-width:782px){.is-style-angled .wp-block-cover__image-background,.is-style-angled .wp-block-cover__video-background{-webkit-clip-path:polygon(0 0,55% 0,65% 100%,0 100%);clip-path:polygon(0 0,55% 0,65% 100%,0 100%)}}.has-foreground-color{color:var(--wp--preset--color--foreground,#000)!important}.has-foreground-background-color{background-color:var(--wp--preset--color--foreground,#000)!important}.has-background-color{color:var(--wp--preset--color--background,#fff)!important}.has-background-background-color{background-color:var(--wp--preset--color--background,#fff)!important}.has-primary-color{color:var(--wp--preset--color--primary,#4b5563)!important}.has-primary-background-color{background-color:var(--wp--preset--color--primary,#4b5563)!important}.has-secondary-color{color:var(--wp--preset--color--secondary,#9ca3af)!important}.has-secondary-background-color{background-color:var(--wp--preset--color--secondary,#9ca3af)!important}.ext.has-text-color h1,.ext.has-text-color h2,.ext.has-text-color h3,.ext.has-text-color h4,.ext.has-text-color h5,.ext.has-text-color h6,.ext.has-text-color p{color:currentColor}.has-white-color{color:var(--wp--preset--color--white,#fff)!important}.has-black-color{color:var(--wp--preset--color--black,#000)!important}.has-ext-foreground-background-color{background-color:var(
        --wp--preset--color--foreground,var(--wp--preset--color--black,#000)
    )!important}.has-ext-primary-background-color{background-color:var(
        --wp--preset--color--primary,var(--wp--preset--color--cyan-bluish-gray,#000)
    )!important}.wp-block-button__link.has-black-background-color{border-color:var(--wp--preset--color--black,#000)}.wp-block-button__link.has-white-background-color{border-color:var(--wp--preset--color--white,#fff)}.has-ext-small-font-size{font-size:var(--wp--preset--font-size--ext-small)!important}.has-ext-medium-font-size{font-size:var(--wp--preset--font-size--ext-medium)!important}.has-ext-large-font-size{font-size:var(--wp--preset--font-size--ext-large)!important;line-height:1.2}.has-ext-x-large-font-size{font-size:var(--wp--preset--font-size--ext-x-large)!important;line-height:1}.has-ext-xx-large-font-size{font-size:var(--wp--preset--font-size--ext-xx-large)!important;line-height:1}.has-ext-x-large-font-size:not([style*=line-height]),.has-ext-xx-large-font-size:not([style*=line-height]){line-height:1.1}.ext .wp-block-group>*{margin-bottom:0;margin-top:0}.ext .wp-block-group>*+*{margin-bottom:0}.ext .wp-block-group>*+*,.ext h2{margin-top:var(--wp--style--block-gap,1.75rem)}.ext h2{margin-bottom:var(--wp--style--block-gap,1.75rem)}.has-ext-x-large-font-size+h3,.has-ext-x-large-font-size+p{margin-top:.5rem}.ext .wp-block-buttons>.wp-block-button.wp-block-button__width-25{min-width:12rem;width:calc(25% - var(--wp--style--block-gap, .5em)*.75)}.ext .ext-grid>[class*=_inner-container]{display:grid}.ext>[class*=_inner-container]>.ext-grid:not([class*=columns]),.ext>[class*=_inner-container]>.wp-block>.ext-grid:not([class*=columns]){display:initial!important}.ext .ext-grid-cols-1>[class*=_inner-container]{grid-template-columns:repeat(1,minmax(0,1fr))!important}.ext .ext-grid-cols-2>[class*=_inner-container]{grid-template-columns:repeat(2,minmax(0,1fr))!important}.ext .ext-grid-cols-3>[class*=_inner-container]{grid-template-columns:repeat(3,minmax(0,1fr))!important}.ext .ext-grid-cols-4>[class*=_inner-container]{grid-template-columns:repeat(4,minmax(0,1fr))!important}.ext .ext-grid-cols-5>[class*=_inner-container]{grid-template-columns:repeat(5,minmax(0,1fr))!important}.ext .ext-grid-cols-6>[class*=_inner-container]{grid-template-columns:repeat(6,minmax(0,1fr))!important}.ext .ext-grid-cols-7>[class*=_inner-container]{grid-template-columns:repeat(7,minmax(0,1fr))!important}.ext .ext-grid-cols-8>[class*=_inner-container]{grid-template-columns:repeat(8,minmax(0,1fr))!important}.ext .ext-grid-cols-9>[class*=_inner-container]{grid-template-columns:repeat(9,minmax(0,1fr))!important}.ext .ext-grid-cols-10>[class*=_inner-container]{grid-template-columns:repeat(10,minmax(0,1fr))!important}.ext .ext-grid-cols-11>[class*=_inner-container]{grid-template-columns:repeat(11,minmax(0,1fr))!important}.ext .ext-grid-cols-12>[class*=_inner-container]{grid-template-columns:repeat(12,minmax(0,1fr))!important}.ext .ext-grid-cols-13>[class*=_inner-container]{grid-template-columns:repeat(13,minmax(0,1fr))!important}.ext .ext-grid-cols-none>[class*=_inner-container]{grid-template-columns:none!important}.ext .ext-grid-rows-1>[class*=_inner-container]{grid-template-rows:repeat(1,minmax(0,1fr))!important}.ext .ext-grid-rows-2>[class*=_inner-container]{grid-template-rows:repeat(2,minmax(0,1fr))!important}.ext .ext-grid-rows-3>[class*=_inner-container]{grid-template-rows:repeat(3,minmax(0,1fr))!important}.ext .ext-grid-rows-4>[class*=_inner-container]{grid-template-rows:repeat(4,minmax(0,1fr))!important}.ext .ext-grid-rows-5>[class*=_inner-container]{grid-template-rows:repeat(5,minmax(0,1fr))!important}.ext .ext-grid-rows-6>[class*=_inner-container]{grid-template-rows:repeat(6,minmax(0,1fr))!important}.ext .ext-grid-rows-none>[class*=_inner-container]{grid-template-rows:none!important}.ext .ext-items-start>[class*=_inner-container]{align-items:flex-start!important}.ext .ext-items-end>[class*=_inner-container]{align-items:flex-end!important}.ext .ext-items-center>[class*=_inner-container]{align-items:center!important}.ext .ext-items-baseline>[class*=_inner-container]{align-items:baseline!important}.ext .ext-items-stretch>[class*=_inner-container]{align-items:stretch!important}.ext.wp-block-group>:last-child{margin-bottom:0}.ext .wp-block-group__inner-container{padding:0!important}.ext.has-background{padding-left:var(--wp--style--block-gap,1.75rem);padding-right:var(--wp--style--block-gap,1.75rem)}.ext [class*=inner-container]>.alignwide [class*=inner-container],.ext [class*=inner-container]>[data-align=wide] [class*=inner-container]{max-width:var(--responsive--alignwide-width,120rem)}.ext [class*=inner-container]>.alignwide [class*=inner-container]>*,.ext [class*=inner-container]>[data-align=wide] [class*=inner-container]>*{max-width:100%!important}.ext .wp-block-image{position:relative;text-align:center}.ext .wp-block-image img{display:inline-block;vertical-align:middle}body{--extendify--spacing--large:var(
        --wp--custom--spacing--large,clamp(2em,8vw,8em)
    );--wp--preset--font-size--ext-small:1rem;--wp--preset--font-size--ext-medium:1.125rem;--wp--preset--font-size--ext-large:clamp(1.65rem,3.5vw,2.15rem);--wp--preset--font-size--ext-x-large:clamp(3rem,6vw,4.75rem);--wp--preset--font-size--ext-xx-large:clamp(3.25rem,7.5vw,5.75rem);--wp--preset--color--black:#000;--wp--preset--color--white:#fff}.ext *{box-sizing:border-box}.block-editor-block-preview__content-iframe .ext [data-type="core/spacer"] .components-resizable-box__container{background:transparent!important}.block-editor-block-preview__content-iframe .ext [data-type="core/spacer"] .block-library-spacer__resize-container:before{display:none!important}.ext .wp-block-group__inner-container figure.wp-block-gallery.alignfull{margin-bottom:unset;margin-top:unset}.ext .alignwide{margin-left:auto!important;margin-right:auto!important}.is-root-container.block-editor-block-list__layout>[data-align=full]:not(:first-of-type)>.ext-my-0,.is-root-container.block-editor-block-list__layout>[data-align=wide]>.ext-my-0:not([style*=margin]){margin-top:calc(var(--wp--style--block-gap, 28px)*-1)!important}.block-editor-block-preview__content-iframe .preview\:min-h-50{min-height:50vw!important}.block-editor-block-preview__content-iframe .preview\:min-h-60{min-height:60vw!important}.block-editor-block-preview__content-iframe .preview\:min-h-70{min-height:70vw!important}.block-editor-block-preview__content-iframe .preview\:min-h-80{min-height:80vw!important}.block-editor-block-preview__content-iframe .preview\:min-h-100{min-height:100vw!important}.ext-mr-0.alignfull:not([style*=margin]):not([style*=margin]){margin-right:0!important}.ext-ml-0:not([style*=margin]):not([style*=margin]){margin-left:0!important}.is-root-container .wp-block[data-align=full]>.ext-mx-0:not([style*=margin]):not([style*=margin]){margin-left:calc(var(--wp--custom--spacing--outer, 0)*1)!important;margin-right:calc(var(--wp--custom--spacing--outer, 0)*1)!important;overflow:hidden;width:unset}@media (min-width:782px){.tablet\:ext-absolute{position:absolute!important}.tablet\:ext-relative{position:relative!important}.tablet\:ext-top-base{top:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-top-lg{top:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--top-base{top:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--top-lg{top:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-right-base{right:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-right-lg{right:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--right-base{right:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--right-lg{right:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-bottom-base{bottom:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-bottom-lg{bottom:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--bottom-base{bottom:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--bottom-lg{bottom:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-left-base{left:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-left-lg{left:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--left-base{left:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--left-lg{left:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-order-1{order:1!important}.tablet\:ext-order-2{order:2!important}.tablet\:ext-m-0:not([style*=margin]){margin:0!important}.tablet\:ext-m-auto:not([style*=margin]){margin:auto!important}.tablet\:ext-m-base:not([style*=margin]){margin:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-m-lg:not([style*=margin]){margin:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--m-base:not([style*=margin]){margin:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--m-lg:not([style*=margin]){margin:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-mx-0:not([style*=margin]){margin-left:0!important;margin-right:0!important}.tablet\:ext-mx-auto:not([style*=margin]){margin-left:auto!important;margin-right:auto!important}.tablet\:ext-mx-base:not([style*=margin]){margin-left:var(--wp--style--block-gap,1.75rem)!important;margin-right:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-mx-lg:not([style*=margin]){margin-left:var(--extendify--spacing--large,3rem)!important;margin-right:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--mx-base:not([style*=margin]){margin-left:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important;margin-right:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--mx-lg:not([style*=margin]){margin-left:calc(var(--extendify--spacing--large, 3rem)*-1)!important;margin-right:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-my-0:not([style*=margin]){margin-bottom:0!important;margin-top:0!important}.tablet\:ext-my-auto:not([style*=margin]){margin-bottom:auto!important;margin-top:auto!important}.tablet\:ext-my-base:not([style*=margin]){margin-bottom:var(--wp--style--block-gap,1.75rem)!important;margin-top:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-my-lg:not([style*=margin]){margin-bottom:var(--extendify--spacing--large,3rem)!important;margin-top:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--my-base:not([style*=margin]){margin-bottom:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important;margin-top:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--my-lg:not([style*=margin]){margin-bottom:calc(var(--extendify--spacing--large, 3rem)*-1)!important;margin-top:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-mt-0:not([style*=margin]){margin-top:0!important}.tablet\:ext-mt-auto:not([style*=margin]){margin-top:auto!important}.tablet\:ext-mt-base:not([style*=margin]){margin-top:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-mt-lg:not([style*=margin]){margin-top:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--mt-base:not([style*=margin]){margin-top:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--mt-lg:not([style*=margin]){margin-top:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-mr-0:not([style*=margin]){margin-right:0!important}.tablet\:ext-mr-auto:not([style*=margin]){margin-right:auto!important}.tablet\:ext-mr-base:not([style*=margin]){margin-right:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-mr-lg:not([style*=margin]){margin-right:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--mr-base:not([style*=margin]){margin-right:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--mr-lg:not([style*=margin]){margin-right:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-mb-0:not([style*=margin]){margin-bottom:0!important}.tablet\:ext-mb-auto:not([style*=margin]){margin-bottom:auto!important}.tablet\:ext-mb-base:not([style*=margin]){margin-bottom:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-mb-lg:not([style*=margin]){margin-bottom:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--mb-base:not([style*=margin]){margin-bottom:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--mb-lg:not([style*=margin]){margin-bottom:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-ml-0:not([style*=margin]){margin-left:0!important}.tablet\:ext-ml-auto:not([style*=margin]){margin-left:auto!important}.tablet\:ext-ml-base:not([style*=margin]){margin-left:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-ml-lg:not([style*=margin]){margin-left:var(--extendify--spacing--large,3rem)!important}.tablet\:ext--ml-base:not([style*=margin]){margin-left:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.tablet\:ext--ml-lg:not([style*=margin]){margin-left:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.tablet\:ext-block{display:block!important}.tablet\:ext-inline-block{display:inline-block!important}.tablet\:ext-inline{display:inline!important}.tablet\:ext-flex{display:flex!important}.tablet\:ext-inline-flex{display:inline-flex!important}.tablet\:ext-grid{display:grid!important}.tablet\:ext-inline-grid{display:inline-grid!important}.tablet\:ext-hidden{display:none!important}.tablet\:ext-w-auto{width:auto!important}.tablet\:ext-w-full{width:100%!important}.tablet\:ext-max-w-full{max-width:100%!important}.tablet\:ext-flex-1{flex:1 1 0%!important}.tablet\:ext-flex-auto{flex:1 1 auto!important}.tablet\:ext-flex-initial{flex:0 1 auto!important}.tablet\:ext-flex-none{flex:none!important}.tablet\:ext-flex-shrink-0{flex-shrink:0!important}.tablet\:ext-flex-shrink{flex-shrink:1!important}.tablet\:ext-flex-grow-0{flex-grow:0!important}.tablet\:ext-flex-grow{flex-grow:1!important}.tablet\:ext-list-none{list-style-type:none!important}.tablet\:ext-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))!important}.tablet\:ext-grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))!important}.tablet\:ext-grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))!important}.tablet\:ext-grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))!important}.tablet\:ext-grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))!important}.tablet\:ext-grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))!important}.tablet\:ext-grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))!important}.tablet\:ext-grid-cols-8{grid-template-columns:repeat(8,minmax(0,1fr))!important}.tablet\:ext-grid-cols-9{grid-template-columns:repeat(9,minmax(0,1fr))!important}.tablet\:ext-grid-cols-10{grid-template-columns:repeat(10,minmax(0,1fr))!important}.tablet\:ext-grid-cols-11{grid-template-columns:repeat(11,minmax(0,1fr))!important}.tablet\:ext-grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))!important}.tablet\:ext-grid-cols-none{grid-template-columns:none!important}.tablet\:ext-flex-row{flex-direction:row!important}.tablet\:ext-flex-row-reverse{flex-direction:row-reverse!important}.tablet\:ext-flex-col{flex-direction:column!important}.tablet\:ext-flex-col-reverse{flex-direction:column-reverse!important}.tablet\:ext-flex-wrap{flex-wrap:wrap!important}.tablet\:ext-flex-wrap-reverse{flex-wrap:wrap-reverse!important}.tablet\:ext-flex-nowrap{flex-wrap:nowrap!important}.tablet\:ext-items-start{align-items:flex-start!important}.tablet\:ext-items-end{align-items:flex-end!important}.tablet\:ext-items-center{align-items:center!important}.tablet\:ext-items-baseline{align-items:baseline!important}.tablet\:ext-items-stretch{align-items:stretch!important}.tablet\:ext-justify-start{justify-content:flex-start!important}.tablet\:ext-justify-end{justify-content:flex-end!important}.tablet\:ext-justify-center{justify-content:center!important}.tablet\:ext-justify-between{justify-content:space-between!important}.tablet\:ext-justify-around{justify-content:space-around!important}.tablet\:ext-justify-evenly{justify-content:space-evenly!important}.tablet\:ext-justify-items-start{justify-items:start!important}.tablet\:ext-justify-items-end{justify-items:end!important}.tablet\:ext-justify-items-center{justify-items:center!important}.tablet\:ext-justify-items-stretch{justify-items:stretch!important}.tablet\:ext-justify-self-auto{justify-self:auto!important}.tablet\:ext-justify-self-start{justify-self:start!important}.tablet\:ext-justify-self-end{justify-self:end!important}.tablet\:ext-justify-self-center{justify-self:center!important}.tablet\:ext-justify-self-stretch{justify-self:stretch!important}.tablet\:ext-p-0:not([style*=padding]){padding:0!important}.tablet\:ext-p-base:not([style*=padding]){padding:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-p-lg:not([style*=padding]){padding:var(--extendify--spacing--large,3rem)!important}.tablet\:ext-px-0:not([style*=padding]){padding-left:0!important;padding-right:0!important}.tablet\:ext-px-base:not([style*=padding]){padding-left:var(--wp--style--block-gap,1.75rem)!important;padding-right:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-px-lg:not([style*=padding]){padding-left:var(--extendify--spacing--large,3rem)!important;padding-right:var(--extendify--spacing--large,3rem)!important}.tablet\:ext-py-0:not([style*=padding]){padding-bottom:0!important;padding-top:0!important}.tablet\:ext-py-base:not([style*=padding]){padding-bottom:var(--wp--style--block-gap,1.75rem)!important;padding-top:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-py-lg:not([style*=padding]){padding-bottom:var(--extendify--spacing--large,3rem)!important;padding-top:var(--extendify--spacing--large,3rem)!important}.tablet\:ext-pt-0:not([style*=padding]){padding-top:0!important}.tablet\:ext-pt-base:not([style*=padding]){padding-top:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-pt-lg:not([style*=padding]){padding-top:var(--extendify--spacing--large,3rem)!important}.tablet\:ext-pr-0:not([style*=padding]){padding-right:0!important}.tablet\:ext-pr-base:not([style*=padding]){padding-right:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-pr-lg:not([style*=padding]){padding-right:var(--extendify--spacing--large,3rem)!important}.tablet\:ext-pb-0:not([style*=padding]){padding-bottom:0!important}.tablet\:ext-pb-base:not([style*=padding]){padding-bottom:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-pb-lg:not([style*=padding]){padding-bottom:var(--extendify--spacing--large,3rem)!important}.tablet\:ext-pl-0:not([style*=padding]){padding-left:0!important}.tablet\:ext-pl-base:not([style*=padding]){padding-left:var(--wp--style--block-gap,1.75rem)!important}.tablet\:ext-pl-lg:not([style*=padding]){padding-left:var(--extendify--spacing--large,3rem)!important}.tablet\:ext-text-left{text-align:left!important}.tablet\:ext-text-center{text-align:center!important}.tablet\:ext-text-right{text-align:right!important}}@media (min-width:1080px){.desktop\:ext-absolute{position:absolute!important}.desktop\:ext-relative{position:relative!important}.desktop\:ext-top-base{top:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-top-lg{top:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--top-base{top:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--top-lg{top:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-right-base{right:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-right-lg{right:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--right-base{right:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--right-lg{right:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-bottom-base{bottom:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-bottom-lg{bottom:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--bottom-base{bottom:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--bottom-lg{bottom:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-left-base{left:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-left-lg{left:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--left-base{left:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--left-lg{left:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-order-1{order:1!important}.desktop\:ext-order-2{order:2!important}.desktop\:ext-m-0:not([style*=margin]){margin:0!important}.desktop\:ext-m-auto:not([style*=margin]){margin:auto!important}.desktop\:ext-m-base:not([style*=margin]){margin:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-m-lg:not([style*=margin]){margin:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--m-base:not([style*=margin]){margin:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--m-lg:not([style*=margin]){margin:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-mx-0:not([style*=margin]){margin-left:0!important;margin-right:0!important}.desktop\:ext-mx-auto:not([style*=margin]){margin-left:auto!important;margin-right:auto!important}.desktop\:ext-mx-base:not([style*=margin]){margin-left:var(--wp--style--block-gap,1.75rem)!important;margin-right:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-mx-lg:not([style*=margin]){margin-left:var(--extendify--spacing--large,3rem)!important;margin-right:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--mx-base:not([style*=margin]){margin-left:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important;margin-right:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--mx-lg:not([style*=margin]){margin-left:calc(var(--extendify--spacing--large, 3rem)*-1)!important;margin-right:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-my-0:not([style*=margin]){margin-bottom:0!important;margin-top:0!important}.desktop\:ext-my-auto:not([style*=margin]){margin-bottom:auto!important;margin-top:auto!important}.desktop\:ext-my-base:not([style*=margin]){margin-bottom:var(--wp--style--block-gap,1.75rem)!important;margin-top:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-my-lg:not([style*=margin]){margin-bottom:var(--extendify--spacing--large,3rem)!important;margin-top:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--my-base:not([style*=margin]){margin-bottom:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important;margin-top:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--my-lg:not([style*=margin]){margin-bottom:calc(var(--extendify--spacing--large, 3rem)*-1)!important;margin-top:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-mt-0:not([style*=margin]){margin-top:0!important}.desktop\:ext-mt-auto:not([style*=margin]){margin-top:auto!important}.desktop\:ext-mt-base:not([style*=margin]){margin-top:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-mt-lg:not([style*=margin]){margin-top:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--mt-base:not([style*=margin]){margin-top:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--mt-lg:not([style*=margin]){margin-top:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-mr-0:not([style*=margin]){margin-right:0!important}.desktop\:ext-mr-auto:not([style*=margin]){margin-right:auto!important}.desktop\:ext-mr-base:not([style*=margin]){margin-right:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-mr-lg:not([style*=margin]){margin-right:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--mr-base:not([style*=margin]){margin-right:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--mr-lg:not([style*=margin]){margin-right:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-mb-0:not([style*=margin]){margin-bottom:0!important}.desktop\:ext-mb-auto:not([style*=margin]){margin-bottom:auto!important}.desktop\:ext-mb-base:not([style*=margin]){margin-bottom:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-mb-lg:not([style*=margin]){margin-bottom:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--mb-base:not([style*=margin]){margin-bottom:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--mb-lg:not([style*=margin]){margin-bottom:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-ml-0:not([style*=margin]){margin-left:0!important}.desktop\:ext-ml-auto:not([style*=margin]){margin-left:auto!important}.desktop\:ext-ml-base:not([style*=margin]){margin-left:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-ml-lg:not([style*=margin]){margin-left:var(--extendify--spacing--large,3rem)!important}.desktop\:ext--ml-base:not([style*=margin]){margin-left:calc(var(--wp--style--block-gap, 1.75rem)*-1)!important}.desktop\:ext--ml-lg:not([style*=margin]){margin-left:calc(var(--extendify--spacing--large, 3rem)*-1)!important}.desktop\:ext-block{display:block!important}.desktop\:ext-inline-block{display:inline-block!important}.desktop\:ext-inline{display:inline!important}.desktop\:ext-flex{display:flex!important}.desktop\:ext-inline-flex{display:inline-flex!important}.desktop\:ext-grid{display:grid!important}.desktop\:ext-inline-grid{display:inline-grid!important}.desktop\:ext-hidden{display:none!important}.desktop\:ext-w-auto{width:auto!important}.desktop\:ext-w-full{width:100%!important}.desktop\:ext-max-w-full{max-width:100%!important}.desktop\:ext-flex-1{flex:1 1 0%!important}.desktop\:ext-flex-auto{flex:1 1 auto!important}.desktop\:ext-flex-initial{flex:0 1 auto!important}.desktop\:ext-flex-none{flex:none!important}.desktop\:ext-flex-shrink-0{flex-shrink:0!important}.desktop\:ext-flex-shrink{flex-shrink:1!important}.desktop\:ext-flex-grow-0{flex-grow:0!important}.desktop\:ext-flex-grow{flex-grow:1!important}.desktop\:ext-list-none{list-style-type:none!important}.desktop\:ext-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))!important}.desktop\:ext-grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))!important}.desktop\:ext-grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))!important}.desktop\:ext-grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))!important}.desktop\:ext-grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))!important}.desktop\:ext-grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))!important}.desktop\:ext-grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))!important}.desktop\:ext-grid-cols-8{grid-template-columns:repeat(8,minmax(0,1fr))!important}.desktop\:ext-grid-cols-9{grid-template-columns:repeat(9,minmax(0,1fr))!important}.desktop\:ext-grid-cols-10{grid-template-columns:repeat(10,minmax(0,1fr))!important}.desktop\:ext-grid-cols-11{grid-template-columns:repeat(11,minmax(0,1fr))!important}.desktop\:ext-grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))!important}.desktop\:ext-grid-cols-none{grid-template-columns:none!important}.desktop\:ext-flex-row{flex-direction:row!important}.desktop\:ext-flex-row-reverse{flex-direction:row-reverse!important}.desktop\:ext-flex-col{flex-direction:column!important}.desktop\:ext-flex-col-reverse{flex-direction:column-reverse!important}.desktop\:ext-flex-wrap{flex-wrap:wrap!important}.desktop\:ext-flex-wrap-reverse{flex-wrap:wrap-reverse!important}.desktop\:ext-flex-nowrap{flex-wrap:nowrap!important}.desktop\:ext-items-start{align-items:flex-start!important}.desktop\:ext-items-end{align-items:flex-end!important}.desktop\:ext-items-center{align-items:center!important}.desktop\:ext-items-baseline{align-items:baseline!important}.desktop\:ext-items-stretch{align-items:stretch!important}.desktop\:ext-justify-start{justify-content:flex-start!important}.desktop\:ext-justify-end{justify-content:flex-end!important}.desktop\:ext-justify-center{justify-content:center!important}.desktop\:ext-justify-between{justify-content:space-between!important}.desktop\:ext-justify-around{justify-content:space-around!important}.desktop\:ext-justify-evenly{justify-content:space-evenly!important}.desktop\:ext-justify-items-start{justify-items:start!important}.desktop\:ext-justify-items-end{justify-items:end!important}.desktop\:ext-justify-items-center{justify-items:center!important}.desktop\:ext-justify-items-stretch{justify-items:stretch!important}.desktop\:ext-justify-self-auto{justify-self:auto!important}.desktop\:ext-justify-self-start{justify-self:start!important}.desktop\:ext-justify-self-end{justify-self:end!important}.desktop\:ext-justify-self-center{justify-self:center!important}.desktop\:ext-justify-self-stretch{justify-self:stretch!important}.desktop\:ext-p-0:not([style*=padding]){padding:0!important}.desktop\:ext-p-base:not([style*=padding]){padding:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-p-lg:not([style*=padding]){padding:var(--extendify--spacing--large,3rem)!important}.desktop\:ext-px-0:not([style*=padding]){padding-left:0!important;padding-right:0!important}.desktop\:ext-px-base:not([style*=padding]){padding-left:var(--wp--style--block-gap,1.75rem)!important;padding-right:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-px-lg:not([style*=padding]){padding-left:var(--extendify--spacing--large,3rem)!important;padding-right:var(--extendify--spacing--large,3rem)!important}.desktop\:ext-py-0:not([style*=padding]){padding-bottom:0!important;padding-top:0!important}.desktop\:ext-py-base:not([style*=padding]){padding-bottom:var(--wp--style--block-gap,1.75rem)!important;padding-top:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-py-lg:not([style*=padding]){padding-bottom:var(--extendify--spacing--large,3rem)!important;padding-top:var(--extendify--spacing--large,3rem)!important}.desktop\:ext-pt-0:not([style*=padding]){padding-top:0!important}.desktop\:ext-pt-base:not([style*=padding]){padding-top:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-pt-lg:not([style*=padding]){padding-top:var(--extendify--spacing--large,3rem)!important}.desktop\:ext-pr-0:not([style*=padding]){padding-right:0!important}.desktop\:ext-pr-base:not([style*=padding]){padding-right:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-pr-lg:not([style*=padding]){padding-right:var(--extendify--spacing--large,3rem)!important}.desktop\:ext-pb-0:not([style*=padding]){padding-bottom:0!important}.desktop\:ext-pb-base:not([style*=padding]){padding-bottom:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-pb-lg:not([style*=padding]){padding-bottom:var(--extendify--spacing--large,3rem)!important}.desktop\:ext-pl-0:not([style*=padding]){padding-left:0!important}.desktop\:ext-pl-base:not([style*=padding]){padding-left:var(--wp--style--block-gap,1.75rem)!important}.desktop\:ext-pl-lg:not([style*=padding]){padding-left:var(--extendify--spacing--large,3rem)!important}.desktop\:ext-text-left{text-align:left!important}.desktop\:ext-text-center{text-align:center!important}.desktop\:ext-text-right{text-align:right!important}}

</style>
<link rel="stylesheet" id="wphb-1-css" href="./Philosophers 01_ Threads and Mutexes - codequoi_files/fb944c00d0457536ad8d8dd922e768a3.css" type="text/css" media="screen">
<link rel="stylesheet" id="wphb-2-css" href="./Philosophers 01_ Threads and Mutexes - codequoi_files/df4cea608508d20f8974c3b416b617b7.css" type="text/css" media="all">
<style id="wphb-2-inline-css" type="text/css">
div#ez-toc-container p.ez-toc-title {font-size: 100%;}div#ez-toc-container p.ez-toc-title {font-weight: 300;}div#ez-toc-container ul li {font-size: 95%;}div#ez-toc-container nav ul ul li ul li {font-size: 90%!important;}div#ez-toc-container {background: #fff;border: 1px solid #aaaaaa;width: 100%;}div#ez-toc-container p.ez-toc-title {color: #aaaaaa;}div#ez-toc-container ul.ez-toc-list a {color: #41c2a6;}div#ez-toc-container ul.ez-toc-list a:hover {color: #41c2a6;}div#ez-toc-container ul.ez-toc-list a:visited {color: #41c2a6;}
</style>
<link rel="preload" as="style" href="https://web.archive.org/web/20220718211836/https://fonts.googleapis.com/css?family=Domine%3A400%7CJosefin+Sans%3A400&amp;subset=latin%2Clatin-ext&amp;ver=1.7.2"><link rel="stylesheet" id="typology-fonts-css" href="./Philosophers 01_ Threads and Mutexes - codequoi_files/css" type="text/css" media="all" onload="this.media=&quot;all&quot;">
<link rel="stylesheet" id="typology-main-css" href="./Philosophers 01_ Threads and Mutexes - codequoi_files/fad46cda7244b1e091cb17e43f793a7a.css" type="text/css" media="all">
<style id="typology-main-inline-css" type="text/css">
body,blockquote:before, q:before{font-family: 'Domine';font-weight: 400;}body,.typology-action-button .sub-menu{color:#444444;}body{background:#f8f8f8;font-size: 1.6rem;}.typology-fake-bg{background:#f8f8f8;}.typology-sidebar,.typology-section{background:#ffffff;}h1, h2, h3, h4, h5, h6,.h1, .h2, .h3, .h4, .h5, .h6,.submit,.mks_read_more a,input[type="submit"],input[type="button"],a.mks_button,.cover-letter,.post-letter,.woocommerce nav.woocommerce-pagination ul li span,.woocommerce nav.woocommerce-pagination ul li a,.woocommerce div.product .woocommerce-tabs ul.tabs li,.typology-pagination a,.typology-pagination span,.comment-author .fn,.post-date-month,.typology-button-social,.meks-instagram-follow-link a,.mks_autor_link_wrap a,.entry-pre-title,.typology-button,button,.wp-block-cover .wp-block-cover-image-text, .wp-block-cover .wp-block-cover-text, .wp-block-cover h2, .wp-block-cover-image .wp-block-cover-image-text, .wp-block-cover-image .wp-block-cover-text, .wp-block-cover-image h2,.wp-block-button__link,body div.wpforms-container-full .wpforms-form input[type=submit], body div.wpforms-container-full .wpforms-form button[type=submit], body div.wpforms-container-full .wpforms-form .wpforms-page-button {font-family: 'Josefin Sans';font-weight: 400;}.typology-header .typology-nav{font-family: 'Josefin Sans';font-weight: 400;}.typology-cover .entry-title,.typology-cover h1 { font-size: 6.4rem;}h1, .h1 {font-size: 4.8rem;}h2, .h2 {font-size: 3.5rem;}h3, .h3 {font-size: 2.8rem;}h4, .h4 {font-size: 2.3rem;}h5, .h5,.typology-layout-c.post-image-on .entry-title,blockquote, q {font-size: 1.8rem;}h6, .h6 {font-size: 1.5rem;}.widget{font-size: 1.4rem;}.typology-header .typology-nav a{font-size: 1.1rem;}.typology-layout-b .post-date-hidden,.meta-item{font-size: 1.3rem;}.post-letter {font-size: 26.0rem;}.typology-layout-c .post-letter{height: 26.0rem;}.cover-letter {font-size: 60.0rem;}h1, h2, h3, h4, h5, h6,.h1, .h2, .h3, .h4, .h5, .h6,h1 a,h2 a,h3 a,h4 a,h5 a,h6 a,.post-date-month{color:#333333;}.typology-single-sticky a{color:#444444;}.entry-title a:hover,.typology-single-sticky a:hover{color:#41c2a6;}.bypostauthor .comment-author:before,#cancel-comment-reply-link:after{background:#41c2a6;}a,.widget .textwidget a,.typology-layout-b .post-date-hidden{color: #41c2a6;}.single .typology-section:first-child .section-content, .section-content-page, .section-content.section-content-a{max-width: 720px;}.typology-header{height:110px;}.typology-header-sticky-on .typology-header{background:#41c2a6;}.cover-letter{padding-top: 110px;}.site-title a,.typology-site-description{color: #ffffff;}.typology-header .typology-nav,.typology-header .typology-nav > li > a{color: #ffffff;}.typology-header .typology-nav .sub-menu a{ color:#444444;}.typology-header .typology-nav .sub-menu a:hover{color: #41c2a6;}.typology-action-button .sub-menu ul a:before{background: #41c2a6;}.sub-menu .current-menu-item a{color:#41c2a6;}.dot,.typology-header .typology-nav .sub-menu{background:#ffffff;}.typology-header .typology-main-navigation .sub-menu .current-menu-ancestor > a,.typology-header .typology-main-navigation .sub-menu .current-menu-item > a{color: #41c2a6;}.typology-header-wide .slot-l{left: 35px;}.typology-header-wide .slot-r{right: 20px;}.meta-item,.meta-item span,.meta-item a,.comment-metadata a{color: #888888;}.comment-meta .url,.meta-item a:hover{color:#333333;}.typology-post:after,.section-title:after,.typology-pagination:before{background:rgba(51,51,51,0.2);}.typology-layout-b .post-date-day,.typology-outline-nav li a:hover,.style-timeline .post-date-day{color:#41c2a6;}.typology-layout-b .post-date:after,blockquote:before,q:before{background:#41c2a6;}.typology-sticky-c,.typology-sticky-to-top span,.sticky-author-date{color: #888888;}.typology-outline-nav li a{color: #444444;}.typology-post.typology-layout-b:before, .section-content-b .typology-ad-between-posts:before{background:rgba(68,68,68,0.1);}.submit,.mks_read_more a,input[type="submit"],input[type="button"],a.mks_button,.typology-button,.submit,.typology-button-social,.page-template-template-authors .typology-author .typology-button-social,.widget .mks_autor_link_wrap a,.widget .meks-instagram-follow-link a,.widget .mks_read_more a,button,body div.wpforms-container-full .wpforms-form input[type=submit], body div.wpforms-container-full .wpforms-form button[type=submit], body div.wpforms-container-full .wpforms-form .wpforms-page-button {color:#ffffff;background: #41c2a6;border:1px solid #41c2a6;}body div.wpforms-container-full .wpforms-form input[type=submit]:hover, body div.wpforms-container-full .wpforms-form input[type=submit]:focus, body div.wpforms-container-full .wpforms-form input[type=submit]:active, body div.wpforms-container-full .wpforms-form button[type=submit]:hover, body div.wpforms-container-full .wpforms-form button[type=submit]:focus, body div.wpforms-container-full .wpforms-form button[type=submit]:active, body div.wpforms-container-full .wpforms-form .wpforms-page-button:hover, body div.wpforms-container-full .wpforms-form .wpforms-page-button:active, body div.wpforms-container-full .wpforms-form .wpforms-page-button:focus {color:#ffffff;background: #41c2a6;border:1px solid #41c2a6;}.page-template-template-authors .typology-author .typology-icon-social:hover {border:1px solid #41c2a6;}.button-invert{color:#41c2a6;background:transparent;}.widget .mks_autor_link_wrap a:hover,.widget .meks-instagram-follow-link a:hover,.widget .mks_read_more a:hover{color:#ffffff;}.typology-cover{min-height: 240px;}.typology-cover-empty{height:209px;min-height:209px;}.typology-fake-bg .typology-section:first-child {top: -99px;}.typology-flat .typology-cover-empty{height:110px;}.typology-flat .typology-cover{min-height:110px;}.typology-cover-empty,.typology-cover,.typology-header-sticky{background: #41c2a6;;}.typology-cover-overlay:after{background: rgba(65,194,166,0.6);}.typology-sidebar-header{background:#41c2a6;}.typology-cover,.typology-cover .entry-title,.typology-cover .entry-title a,.typology-cover .meta-item,.typology-cover .meta-item span,.typology-cover .meta-item a,.typology-cover h1,.typology-cover h2,.typology-cover h3{color: #ffffff;}.typology-cover .typology-button{color: #41c2a6;background:#ffffff;border:1px solid #ffffff;}.typology-cover .button-invert{color: #ffffff;background: transparent;}.typology-cover-slider .owl-dots .owl-dot span{background:#ffffff;}.typology-outline-nav li:before,.widget ul li:before{background:#41c2a6;}.widget a{color:#444444;}.widget a:hover,.widget_calendar table tbody td a,.entry-tags a:hover,.wp-block-tag-cloud a:hover{color:#41c2a6;}.widget_calendar table tbody td a:hover,.widget table td,.entry-tags a,.wp-block-tag-cloud a{color:#444444;}.widget table,.widget table td,.widget_calendar table thead th,table,td, th{border-color: rgba(68,68,68,0.3);}.widget ul li,.widget .recentcomments{color:#444444;}.widget .post-date{color:#888888;}#today{background:rgba(68,68,68,0.1);}.typology-pagination .current, .typology-pagination .infinite-scroll a, .typology-pagination .load-more a, .typology-pagination .nav-links .next, .typology-pagination .nav-links .prev, .typology-pagination .next a, .typology-pagination .prev a{color: #ffffff;background:#333333;}.typology-pagination a, .typology-pagination span{color: #333333;border:1px solid #333333;}.typology-footer{background:#f8f8f8;color:#aaaaaa;}.typology-footer h1,.typology-footer h2,.typology-footer h3,.typology-footer h4,.typology-footer h5,.typology-footer h6,.typology-footer .post-date-month{color:#aaaaaa;}.typology-count{background: #41c2a6;}.typology-footer a, .typology-footer .widget .textwidget a{color: #888888;}input[type="text"], input[type="email"],input[type=search], input[type="url"], input[type="tel"], input[type="number"], input[type="date"], input[type="password"], textarea, select{border-color:rgba(68,68,68,0.2);}blockquote:after, blockquote:before, q:after, q:before{-webkit-box-shadow: 0 0 0 10px #ffffff;box-shadow: 0 0 0 10px #ffffff;}pre,.entry-content #mc_embed_signup{background: rgba(68,68,68,0.1);}.wp-block-button__link{background: #41c2a6;color: #ffffff; }.wp-block-image figcaption,.wp-block-audio figcaption{color: #444444;}.wp-block-pullquote:not(.is-style-solid-color) blockquote{border-top:2px solid #444444;border-bottom:2px solid #444444;}.wp-block-pullquote.is-style-solid-color{background: #41c2a6;color: #ffffff; }.wp-block-separator{border-color: rgba(68,68,68,0.3);}body.wp-editor{background:#ffffff;}.has-small-font-size{ font-size: 1.3rem;}.has-large-font-size{ font-size: 1.9rem;}.has-huge-font-size{ font-size: 2.2rem;}@media(min-width: 801px){.has-small-font-size{ font-size: 1.3rem;}.has-normal-font-size{ font-size: 1.6rem;}.has-large-font-size{ font-size: 2.2rem;}.has-huge-font-size{ font-size: 2.9rem;}}.has-typology-acc-background-color{ background-color: #41c2a6;}.has-typology-acc-color{ color: #41c2a6;}.has-typology-txt-background-color{ background-color: #444444;}.has-typology-txt-color{ color: #444444;}.has-typology-meta-background-color{ background-color: #888888;}.has-typology-meta-color{ color: #888888;}.has-typology-bg-background-color{ background-color: #ffffff;}.has-typology-bg-color{ color: #ffffff;}.site-title{text-transform: none;}.typology-site-description{text-transform: none;}.typology-nav{text-transform: uppercase;}h1, h2, h3, h4, h5, h6, .wp-block-cover-text, .wp-block-cover-image-text{text-transform: none;}.section-title{text-transform: uppercase;}.widget-title{text-transform: uppercase;}.meta-item{text-transform: none;}.typology-button{text-transform: uppercase;}.submit,.mks_read_more a,input[type="submit"],input[type="button"],a.mks_button,.typology-button,.widget .mks_autor_link_wrap a,.widget .meks-instagram-follow-link a,.widget .mks_read_more a,button,.typology-button-social,.wp-block-button__link,body div.wpforms-container-full .wpforms-form input[type=submit], body div.wpforms-container-full .wpforms-form button[type=submit], body div.wpforms-container-full .wpforms-form .wpforms-page-button {text-transform: uppercase;}
</style>
<link rel="stylesheet" id="typology_child_style-css" href="./Philosophers 01_ Threads and Mutexes - codequoi_files/c84ff7f32efba145f59b27543bbce48e.css" type="text/css" media="screen">
<link rel="stylesheet" id="wphb-3-css" href="./Philosophers 01_ Threads and Mutexes - codequoi_files/bc57d9ceff2f4f9bc78803958e142b68.css" type="text/css" media="all">
<script type="text/javascript" src="./Philosophers 01_ Threads and Mutexes - codequoi_files/d88421387df3aa6e804b192eb8157ee0.js" id="wphb-4-js"></script>
<link rel="https://api.w.org/" href="https://www.codequoi.com/wp-json/"><link rel="alternate" type="application/json" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-json/wp/v2/posts/3448"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.codequoi.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.codequoi.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 6.0.1">
<link rel="shortlink" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/?p=3448">
<link rel="alternate" type="application/json+oembed" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.codequoi.com%2Fen%2Fphilosophers-01-threads-and-mutexes%2F">
<link rel="alternate" type="text/xml+oembed" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.codequoi.com%2Fen%2Fphilosophers-01-threads-and-mutexes%2F&amp;format=xml">
<meta name="generator" content="Redux 4.3.15"><script>var ms_grabbing_curosr = 'https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/plugins/master-slider/public/assets/css/common/grabbing.cur', ms_grab_curosr = 'https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/plugins/master-slider/public/assets/css/common/grab.cur';</script>
<meta name="generator" content="MasterSlider 3.8.1 - Responsive Touch Image Slider | avt.li/msf">
		<script>
			document.documentElement.className = document.documentElement.className.replace( 'no-js', 'js' );
		</script>
				<style>
			.no-js img.lazyload { display: none; }
			figure.wp-block-image img.lazyloading { min-width: 150px; }
							.lazyload, .lazyloading { opacity: 0; }
				.lazyloaded {
					opacity: 1;
					transition: opacity 400ms;
					transition-delay: 0ms;
				}
					</style>
		<link rel="icon" href="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2021/12/cropped-android-chrome-512x512-1-32x32.png" sizes="32x32">
<link rel="icon" href="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2021/12/cropped-android-chrome-512x512-1-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2021/12/cropped-android-chrome-512x512-1-180x180.png">
<meta name="msapplication-TileImage" content="https://www.codequoi.com/wp-content/uploads/2021/12/cropped-android-chrome-512x512-1-270x270.png">
	</head>

	<body class="post-template-default single single-post postid-3448 single-format-standard wp-embed-responsive _masterslider _ms_version_3.8.1 typology-v_1_7_2 typology-child"><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr; height: 66px;">
</div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(675,27,25,2,"web","https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/","20220718211836",1996,"/_static/",["/_static/css/banner-styles.css?v=S1zqJCYt","/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->

		
			<header id="typology-header" class="typology-header">
				<div class="container">
					<div class="slot-l">
	<div class="typology-site-branding">
	
	<span class="site-title h4"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/" rel="home"><img alt="codequoi" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/codequoi-logo-200x71-1.png" class="typology-logo lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img alt="codequoi" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/codequoi-logo-200x71-1.png" class="typology-logo lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img class="typology-logo" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/codequoi-logo-200x71-1.png" alt="codequoi"></noscript></a></span>	
</div>
	
</div>

<div class="slot-r">
				<ul id="menu-main-menu-english" class="typology-nav typology-main-navigation"><li id="menu-item-584" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-584"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/">Home</a></li>
<li id="menu-item-1028" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-1028"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#">Categories</a>
<ul class="sub-menu">
	<li id="menu-item-1029" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1029"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/42-school-projects/">42 School Projects</a></li>
	<li id="menu-item-1030" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1030"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/c-programming/">C Programming</a></li>
	<li id="menu-item-1031" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1031"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/computer-science/">Computer Science</a></li>
	<li id="menu-item-3419" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3419"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/methodology/">Methodology</a></li>
	<li id="menu-item-1032" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1032"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/programming-tools/">Programming Tools</a></li>
</ul>
</li>
<li id="menu-item-933" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-933"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/about/">About</a></li>
<li id="menu-item-601" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-601"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/contact-en/">Contact</a></li>
<li id="menu-item-583-fr" class="lang-item lang-item-19 lang-item-fr lang-item-first menu-item menu-item-type-custom menu-item-object-custom menu-item-583-fr"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/philosophers-01-threads-et-mutex/" hreflang="fr-FR" lang="fr-FR"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAMAAABBPP0LAAAAbFBMVEVzldTg4ODS0tLxDwDtAwDjAADD0uz39/fy8vL3k4nzgna4yOixwuXu7u7s6+zn5+fyd2rvcGPtZljYAABrjNCpvOHrWkxegsqfs93NAADpUUFRd8THAABBa7wnVbERRKa8vLyxsLCoqKigoKClCvcsAAAAXklEQVR4AS3JxUEAQQAEwZo13Mk/R9w5/7UERJCIGIgj5qfRJZEpPyNfCgJTjMR1eRRnJiExFJz5Mf1PokWr/UztIjRGQ3V486u0HO55m634U6dMcf0RNPfkVCTvKjO16xHA8miowAAAAABJRU5ErkJggg==" alt="Français" width="16" height="11" style="width: 16px; height: 11px;"></a></li>
</ul>			
	<ul class="typology-nav typology-actions-list">
    <li class="typology-actions-button typology-action-search">
	<span>
		<i class="fa fa-search"></i>
	</span>
	<ul class="sub-menu">
		<li>
			<form class="typology-search-form" action="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/" method="get">
	<input name="s" type="text" value="" placeholder="Type here to search...">
	<button type="submit" class="typology-button typology-button-search typology-icon-button">Search</button> 
			<input type="hidden" name="lang" value="en">
	</form>		</li>
	</ul>
</li><li class="typology-action-button typology-action-sidebar typology-mobile-visible">
		<span>
			<i class="fa fa-bars"></i>
		</span>
</li>
</ul></div>				</div>
			</header>

		
	
			
        				<div id="typology-cover" class="typology-cover typology-cover-empty">
            		</div>
		<div class="typology-fake-bg">
			<div class="typology-section">
				    
				<div class="section-content">
    <article id="post-3448" class="typology-post typology-single-post post-3448 post type-post status-publish format-standard has-post-thumbnail hentry category-42-school-projects tag-42-cursus tag-c-en tag-concurrency tag-data-race-en tag-deadlock-en tag-mutex-en tag-thread-en">
	
	            
            <header class="entry-header">

                <h1 class="entry-title entry-title-cover-empty">Philosophers 01: Threads and Mutexes</h1>
                                    <div class="entry-meta"><div class="meta-item meta-author">By <span class="vcard author"><span class="fn"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/author/mcombeau/">Mia Combeau</a></span></span></div><div class="meta-item meta-category">In <a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/42-school-projects/" rel="category tag">42 School Projects</a></div><div class="meta-item meta-date"><span class="updated">July 18, 2022</span></div><div class="meta-item meta-rtime">45 Min read</div><div class="meta-item meta-comments"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#respond">Add comment</a></div></div>
                
                                    <div class="post-letter">P</div>
                
            </header>

                
        <div class="entry-content clearfix">
                        
            
            
<p>The 42 school project philosophers confronts us with the concepts of concurrent programming. The mandatory part of the project introduces us to execution threads as well as the problems that inevitably arise from their shared memory. To rectify these, we will have to put mutexes to good use in order to control access to specific data. We will also need to be wary of our philosopher’s sequencing to avoid any deadlocks.</p>



<p>The bonus part of the philosophers project consists of finding another solution to the same problem, but with processes instead of threads and semaphores instead of mutexes. This will be covered in a second article.</p>



<p class="has-typology-bg-color has-typology-acc-background-color has-text-color has-background">This is not a step-by step tutorial and there will be no ready-made solutions. It is a walkthrough, a guide to explore the issues and concepts behind the subject, the possible approaches we might take, and some tips to test our code.</p>



<p class="has-text-align-center">Read&nbsp;<a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers.en_.subject.pdf">the subject [pdf]</a>&nbsp;at the time of this writing.</p>



<div id="ez-toc-container" class="ez-toc-v2_0_28 counter-hierarchy">
<div class="ez-toc-title-container">
<p class="ez-toc-title">Table of Contents</p>
<span class="ez-toc-title-toggle"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#" class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle" style="display: none;"><label for="item" aria-label="Table of Content"><i class="ez-toc-glyphicon ez-toc-icon-toggle"></i></label><input type="checkbox" id="item"></a></span></div>
<nav><ul class="ez-toc-list ez-toc-list-level-1"><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-1" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#the_rules_of_the_philosophers_project" title="The Rules of the Philosophers Project">The Rules of the Philosophers Project</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-2" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#the_philosophers_circumstances" title="The Philosophers’ Circumstances">The Philosophers’ Circumstances</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-3" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#the_philosophers_dilemma" title="The Philosopher’s Dilemma">The Philosopher’s Dilemma</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-4" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#saving_the_philosophers" title="Saving the Philosophers!">Saving the Philosophers!</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-5" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#the_philosophers_program_output" title="The Philosophers Program Output">The Philosophers Program Output</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-6" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#concurrent_programming" title="Concurrent Programming">Concurrent Programming</a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-7" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#what_is_a_thread" title="What is a Thread?">What is a Thread?</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-8" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#using_posix_pthreads" title="Using POSIX Pthreads">Using POSIX Pthreads</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-9" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#creating_a_thread" title="Creating a Thread">Creating a Thread</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-10" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#joining_or_detaching_threads" title="Joining or Detaching Threads">Joining or Detaching Threads</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-11" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#a_practical_example_of_threads" title="A Practical Example of Threads">A Practical Example of Threads</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-12" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#managing_threads_shared_memory" title="Managing Threads’ Shared Memory">Managing Threads’ Shared Memory</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-13" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#synchronization_errors" title="Synchronization Errors">Synchronization Errors</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-14" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#the_danger_of_data_races" title="The Danger of Data Races">The Danger of Data Races</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-15" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#what_is_a_mutex" title="What is a Mutex ?">What is a Mutex ?</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-16" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#beware_of_deadlocks" title="Beware of Deadlocks">Beware of Deadlocks</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-17" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#dealing_with_deadlocks" title="Dealing with Deadlocks">Dealing with Deadlocks</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-18" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#managing_time_in_the_philosophers_project" title="Managing Time in the Philosophers Project">Managing Time in the Philosophers Project</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-19" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#the_gettimeofday_function" title="The Gettimeofday Function">The Gettimeofday Function</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-20" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#the_usleep_function" title="The Usleep Function">The Usleep Function</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-21" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#example_of_time_display_in_milliseconds" title="Example of Time Display in Milliseconds">Example of Time Display in Milliseconds</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-22" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#strategies_for_the_philosophers_project" title="Strategies for the Philosophers Project">Strategies for the Philosophers Project</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-23" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#detecting_death_in_the_philosophers_project" title="Detecting Death in the Philosophers Project">Detecting Death in the Philosophers Project</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-24" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#the_usleep_problem_in_the_philosophers_project" title="The Usleep Problem in the Philosophers Project">The Usleep Problem in the Philosophers Project</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-25" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#handling_forks_in_the_philosophers_project" title="Handling Forks in the Philosophers Project">Handling Forks in the Philosophers Project</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-26" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#giving_the_philosophers_time_to_think" title="Giving the Philosophers Time to Think">Giving the Philosophers Time to Think</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-27" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#the_case_of_the_lone_philosopher" title="The Case of the Lone Philosopher">The Case of the Lone Philosopher</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-28" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#tips_for_testing_the_philosophers_project" title="Tips for Testing the Philosophers Project">Tips for Testing the Philosophers Project</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-29" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#tools_to_test_the_philosophers_project" title="Tools to Test the Philosophers Project">Tools to Test the Philosophers Project</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-30" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#tests_and_expected_results_for_the_philosophers_project" title="Tests and Expected Results for the Philosophers Project">Tests and Expected Results for the Philosophers Project</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-31" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#completed_code_for_the_philosophers_project" title="Completed Code for the Philosophers Project">Completed Code for the Philosophers Project</a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-32" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#sources_and_further_reading" title="Sources and Further Reading">Sources and Further Reading</a></li></ul></nav></div>
<h2><span class="ez-toc-section" id="the_rules_of_the_philosophers_project"></span>The Rules of the Philosophers Project<span class="ez-toc-section-end"></span></h2>



<p>Formulated in 1965 by Edsger Dijkstra, the dining philosophers problem is a computer science puzzle about concurrent programming. The exercise illustrates the synchronization and shared memory issues among different execution threads. The mandatory part of our philosophers project describes a version of this classic problem which we will study below. It differs slightly from the bonus part version, which will be described in the next article.</p>



<h3><span class="ez-toc-section" id="the_philosophers_circumstances"></span>The Philosophers’ Circumstances<span class="ez-toc-section-end"></span></h3>



<p>One or more philosophers are having dinner around a circular table. Each philosopher has their own plate and is sitting between two other philosophers, philosopher N -1 and N + 1. Naturally, the last philosopher is sitting near the first. There is a fork between each of their plates and a large dish of spaghetti at the center of the table.</p>



<figure class="wp-block-image size-large"><img width="1024" height="1024" alt="Illustration of the dining philosophers problem presented in the mandatory part of the 42 school philosophers project. 5 philosophers are sitting around a table at the center of which is a bowl of spaghetti. Each philosopher has a plate and between each philosopher is a fork. They need two forks in order to eat the spaghetti." data-srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-1024x1024.png 1024w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-300x300.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-150x150.png 150w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-768x768.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-720x720.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-580x580.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-320x320.png 320w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers.png 1200w" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-1024x1024.png" data-sizes="(max-width: 1024px) 100vw, 1024px" class="wp-image-2836 lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img width="1024" height="1024" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-1024x1024.png" alt="Illustration of the dining philosophers problem presented in the mandatory part of the 42 school philosophers project. 5 philosophers are sitting around a table at the center of which is a bowl of spaghetti. Each philosopher has a plate and between each philosopher is a fork. They need two forks in order to eat the spaghetti." class="wp-image-2836" srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-1024x1024.png 1024w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-300x300.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-150x150.png 150w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-768x768.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-720x720.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-580x580.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-320x320.png 320w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px"/></noscript><figcaption>Illustration of the dining philosophers project with 5 philosophers. Clockwise:  Sophocles, Plato, Aristotle, Democritus, and Epicurus.</figcaption></figure>



<p>Each philosopher will need to eat before falling asleep. When he wakes up, he will do some thinking before attempting to eat again.</p>



<h3><span class="ez-toc-section" id="the_philosophers_dilemma"></span>The Philosopher’s Dilemma<span class="ez-toc-section-end"></span></h3>



<p>So far, so good. The problem comes from the fact that <strong>in order to eat, each philosopher must use two forks</strong>. It must be a very special type of spaghetti to require two forks! More intuitively, we could imagine the forks being chopsticks instead. So a philosopher must grab the fork to his right and the one to his left. But there are only as many forks as there are philosophers. This means that in order to eat, a philosopher must borrow his neighbor’s fork. His neighbor can’t eat at the same time. Only when his meal is done, when he is ready for his nap, will he set his forks back down on the table.</p>



<p>Of course, there are also time constraints. A philosopher can die of starvation if he fails to acquire a fork! Our program will take the following arguments:</p>



<ul><li><strong><code>number_of_philosophers</code></strong>: the number of philosophers around the table,</li><li><code><strong>time_to_die</strong></code>: a number representing the time in milliseconds a philosopher has to live after a meal. If a philosopher hasn’t started eating <code>time_to_die</code> milliseconds after the beginning of his last meal or the beginning of the simulation, he will die.</li><li><strong><code>time_to_eat</code></strong>: a number representing the time in milliseconds a philosopher takes to finish his meal. During that time, the philosopher keeps his two forks in hand.</li><li><strong><code>time_to_sleep</code></strong>: the time in milliseconds that a philosopher spends sleeping.</li><li><code><strong>number_of_times_each_philosopher_must_eat</strong></code>: an optional argument that allows the program to stop if all the philosophers have eaten at least that many times. If this argument is not specified, the simulation carries on unless a philosopher dies.</li></ul>



<p>And on top of everything, our philosophers are also blind, deaf and mute! They <strong>cannot communicate with each other</strong> and therefore cannot warn each other if one of them is about to die.</p>



<h3><span class="ez-toc-section" id="saving_the_philosophers"></span>Saving the Philosophers!<span class="ez-toc-section-end"></span></h3>



<p>The goal of our program for the philosophers project is therefore to elaborate a sequencing algorithm so that the philosophers can take turns eating, without any of them starving to death. There will be unavoidable casualties in certain cases (for example when there is only one philosopher or when the <code>time_to_die</code> is smaller than the <code>time_to_eat</code> or the <code>time_to_sleep</code>), but we will strive to keep all the philosophers alive as much as possible.</p>



<h3><span class="ez-toc-section" id="the_philosophers_program_output"></span>The Philosophers Program Output<span class="ez-toc-section-end"></span></h3>



<p>Each time a philosopher takes an action, our program must print a message formatted this way:</p>


<pre class="wp-block-code has-small-font-size" aria-describedby="shcb-language-1" data-shcb-language-name="plaintext" data-shcb-language-slug="plaintext"><link rel="stylesheet" id="syntax-highlighting-code-block-css" href="./Philosophers 01_ Threads and Mutexes - codequoi_files/83663f5e4642130181912637b00be283.css" type="text/css" media="all"><style>.wp-block-code {
	border: 0;
	padding: 0;
}

.wp-block-code > div {
	overflow: auto;
}

.shcb-language {
	border: 0;
	clip: rect(1px, 1px, 1px, 1px);
	-webkit-clip-path: inset(50%);
	clip-path: inset(50%);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
	word-wrap: normal;
	word-break: normal;
}

.hljs {
	box-sizing: border-box;
}

.hljs.shcb-code-table {
	display: table;
	width: 100%;
}

.hljs.shcb-code-table > .shcb-loc {
	color: inherit;
	display: table-row;
	width: 100%;
}

.hljs.shcb-code-table .shcb-loc > span {
	display: table-cell;
}

.wp-block-code code.hljs:not(.shcb-wrap-lines) {
	white-space: pre;
}

.wp-block-code code.hljs.shcb-wrap-lines {
	white-space: pre-wrap;
}

.hljs.shcb-line-numbers {
	border-spacing: 0;
	counter-reset: line;
}

.hljs.shcb-line-numbers > .shcb-loc {
	counter-increment: line;
}

.hljs.shcb-line-numbers .shcb-loc > span {
	padding-left: 0.75em;
}

.hljs.shcb-line-numbers .shcb-loc::before {
	border-right: 1px solid #ddd;
	content: counter(line);
	display: table-cell;
	padding: 0 0.75em;
	text-align: right;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
	white-space: nowrap;
	width: 1%;
}
</style><div><code class="hljs language-plaintext">[timestamp_in_ms] [X] has taken a fork
[timestamp_in_ms] [X] is eating
[timestamp_in_ms] [X] is sleeping
[timestamp_in_ms] [X] is thinking
[timestamp_in_ms] [X] died</code></div><small class="shcb-language" id="shcb-language-1"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">plaintext</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">plaintext</span><span class="shcb-language__paren">)</span></small></pre>


<p>Of course, we must replace <code>[timestamp_in_ms]</code> by the actual number of milliseconds elapsed since the start of the simulation, and <code>[X]</code> by the ID of the philosopher in question. In the examples of this article, we will use IDs ranging from <code>1</code> to <code>number_of_philosophers</code> – 1 for clarity. But let’s keep in mind that the subject explicitely<strong> requires philosophers to be numbered <code>1</code> through <code>number_of_philosophers</code></strong>.</p>



<h2><span class="ez-toc-section" id="concurrent_programming"></span>Concurrent Programming<span class="ez-toc-section-end"></span></h2>



<p>The philosophers project requires us to confront concurrent programming. As opposed to sequential programming, concurrent programming allows a program to perform several tasks simultaneously instead of having to wait for the result of one operation to move onto the next. The operating system itself uses this concept to meet its users expectations. If we had to wait for a song to finish to be able to open our browser, or if we had to restart the computer to kill a program caught in an infinite loop, we’d die of frustration!</p>



<p>There are three ways to implement concurrency in our programs, but we will only concentrate on two of them: processes and threads.</p>



<p>We will take a closer look at implementing concurrency with processes in the bonus part of the philosophers project. However, it will be useful to have some sense of this subject in order to understand threads better. When our program is running, it is known as a process. This process can create child processes that run simultaneously. We’ve touched on this idea in <a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/pipex-reproducing-the-pipe-operator-in-c/">the pipex project</a>, where we had to create several child processes to execute simultaneous commands. Child processes created this way are clones of their parent. They are independent and have their own memory resources.</p>



<p>This means that one process can’t very easily communicate with another one without some kind of inter-process communication mechanism. This flaw is also a strength: a process cannot accidentally overwrite another’s virtual memory. However, a concurrent program that uses processes will tend to be slower because of its significant overhead.</p>



<p>So let’s take a look at concurrent programming with threads, which also have their own pros and cons.</p>



<h2><span class="ez-toc-section" id="what_is_a_thread"></span>What is a Thread?<span class="ez-toc-section-end"></span></h2>



<p>An execution <strong>thread</strong> is a logical sequence of instructions inside a process that is automatically managed by the operating system’s kernel. A regular sequential program has a single thread, but modern operating systems allow us to create several threads in our programs, all of which run in parallel.</p>



<p>Each one of a process’s threads has its own context: its own ID, its own stack, its own instruction pointer, it’s own processor register. But since all of the threads are part of the same process, they share the same virtual memory address space: the same code, the same heap, the same shared libraries and the same open file descriptors.</p>



<p>A thread’s context has a smaller footprint in terms of resources than the context of a process. Which means that it is much faster for the system to switch from one thread to the other, compared to switching from one process to another.</p>



<p>Threads don’t have the strict parent-child hierarchy that processes do. Rather, they form a group of peers regardless of which thread created which other thread. The only distinction the “main” thread has is being the first one to exist at the beginning of the process. This means that within the same process, any thread can wait for any other thread to complete, or kill any other thread. Additionally, any thread can read and write to the same virtual memory. We will later examine the problems that can arise from that fact.</p>



<h3><span class="ez-toc-section" id="using_posix_pthreads"></span>Using POSIX Pthreads<span class="ez-toc-section-end"></span></h3>



<p>The standard interface in C to manipulate threads is POSIX with its <strong>&lt;pthread.h&gt;</strong> library. It contains around sixty functions to create, kill and join threads, as well as to manage their shared memory. We will only use a fraction of these in the philosophers project. In order to compile a program using this library, we can’t forget to use <code>gcc</code>‘s <code>-pthread</code> option:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-2" data-shcb-language-name="plaintext" data-shcb-language-slug="plaintext"><div><code class="hljs language-plaintext">gcc -pthread main.c</code></div><small class="shcb-language" id="shcb-language-2"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">plaintext</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">plaintext</span><span class="shcb-language__paren">)</span></small></pre>


<h3><span class="ez-toc-section" id="creating_a_thread"></span>Creating a Thread<span class="ez-toc-section-end"></span></h3>



<p>We can create a new thread from any other thread of the program with the <code>pthread_create</code> function. Its prototype is:</p>


<pre class="wp-block-code has-normal-font-size" aria-describedby="shcb-language-3" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">pthread_create</span><span class="hljs-params">(<span class="hljs-keyword">pthread_t</span> *<span class="hljs-keyword">restrict</span> thread,
                          <span class="hljs-keyword">const</span> <span class="hljs-keyword">pthread_attr_t</span> *<span class="hljs-keyword">restrict</span> attr,
                          <span class="hljs-keyword">void</span> *(*start_routine)(<span class="hljs-keyword">void</span> *),
                          <span class="hljs-keyword">void</span> *<span class="hljs-keyword">restrict</span> arg)</span></span>;</code></div><small class="shcb-language" id="shcb-language-3"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>Let’s examine each argument we must supply:</p>



<ul><li><strong>thread</strong>: a pointer towards a <code>pthread_t</code> type variable, to store the ID of the thread we will be creating.</li><li><strong>attr</strong>: an argument that allows us to change the default attributes of the new thread. This is beyond the scope of our philosophers project, so we will only ever pass <code>NULL</code> here.</li><li><strong>start_routine</strong>: the function where the thread will start its execution. This function will have as its prototype: <code><strong>void *function_name(void *arg);</strong></code>. When the thread reaches the end of this function, it will be done with its tasks.</li><li><strong>arg</strong>: a pointer towards an argument to pass to the thread’s <code>start_routine</code> function. In order to pass several parameters to this function, we will need to give it a pointer to a data structure.</li></ul>



<p>When the <code>pthread_create</code> function ends, the thread variable we gave it should contain the newly created thread’s ID. The function itself returns 0 if the creation was successful, or another value if an error occurred.</p>



<h3><span class="ez-toc-section" id="joining_or_detaching_threads"></span>Joining or Detaching Threads<span class="ez-toc-section-end"></span></h3>



<p>In order to block the execution of a thread until another thread finishes, we can use the <code>pthread_join</code> function:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-4" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">pthread_join</span><span class="hljs-params">(<span class="hljs-keyword">pthread_t</span> thread, <span class="hljs-keyword">void</span> **retval)</span></span>;</code></div><small class="shcb-language" id="shcb-language-4"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>Its parameters are as follows:</p>



<ul><li><strong>thread</strong>: the ID of the thread that this thread should wait for. The specified thread must be joinable (meaning not detached – see below).</li><li><strong>retval</strong>: a pointer towards a variable that can contain the return value of the thread’s routine function (the <code>start_routine</code> function we supplied at its creation). Here, we will not need this value: a simple <code>NULL</code> will suffice.</li></ul>



<p>The <code>pthread_join</code> function returns 0 for success, or another number representing an error code.</p>



<p>Let’s note that we can only wait for the termination of a specific thread. There is no way to wait for the first terminated thread without specifying an ID, as the <code>wait</code> function for child processes does.</p>



<p>For the philosopher project, we will no doubt want to make our program’s main thread wait for each philosopher thread to finish. That way we will be able to free any memory and cleanly and safely terminate the program.</p>



<p>But in some cases, it is possible and preferable to not wait for the end of certain theads at all. In that case, we can detach the thread to tell the operating system that it can reclaim its resources right away when it finishes its execution. For that, we use the <code>pthread_detach</code> function (usually right after that thread’s creation):</p>


<pre class="wp-block-code" aria-describedby="shcb-language-5" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">pthread_detach</span><span class="hljs-params">(<span class="hljs-keyword">pthread_t</span> thread)</span></span>;</code></div><small class="shcb-language" id="shcb-language-5"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>Here, all we have to supply if the thread’s ID. We get 0 in return if the operation was a success, or non-zero if there was an error. After detaching the thread, other threads will not be able to kill or wait for this thread with <code>pthread_join</code>.</p>



<h3><span class="ez-toc-section" id="a_practical_example_of_threads"></span>A Practical Example of Threads<span class="ez-toc-section-end"></span></h3>



<p>Let’s write a small, simple program that creates two threads and joins them. The routine of each thread only consists of writing its own ID followed by a roughly-translated philosophic quote from the French novelist Victor Hugo.</p>


<pre class="wp-block-code has-small-font-size" aria-describedby="shcb-language-6" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp shcb-code-table shcb-line-numbers"><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;pthread.h&gt;</span></span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta"># <span class="hljs-meta-keyword">define</span> NC	<span class="hljs-meta-string">"\e[0m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta"># <span class="hljs-meta-keyword">define</span> YELLOW	<span class="hljs-meta-string">"\e[1;33m"</span></span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">// thread_routine is the function the thread invokes right after its</span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">// creation. The thread ends at the end of this function.</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">void</span>	*<span class="hljs-title">thread_routine</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *data)</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-params"></span>{</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span> tid;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// Note that the pthread_self() function</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// is NOT allowed in the philosophers project !</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// We are only using it here as an example</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// to display this thread's ID.</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	tid = pthread_self();</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: The heaviest burden is to exist without living.%s\n"</span>,</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">		YELLOW, tid, NC);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">return</span> (<span class="hljs-literal">NULL</span>); <span class="hljs-comment">// The thread ends here.</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">}</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-keyword">int</span>	<span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-params"></span>{</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid1;	<span class="hljs-comment">// First thread's ID</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid2;	<span class="hljs-comment">// Second thread's ID</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Creating the first thread that will go</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// execute its thread_routine function.</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_create(&amp;tid1, <span class="hljs-literal">NULL</span>, thread_routine, <span class="hljs-literal">NULL</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Created first thread [%ld]\n"</span>, tid1);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Creating the second thread that will also execute thread_routine.</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_create(&amp;tid2, <span class="hljs-literal">NULL</span>, thread_routine, <span class="hljs-literal">NULL</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Created second thread [%ld]\n"</span>, tid2);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// The main thread waits for the new threads to end</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// with pthread_join.</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_join(tid1, <span class="hljs-literal">NULL</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Joining first thread [%ld]\n"</span>, tid1);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_join(tid2, <span class="hljs-literal">NULL</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Joining second thread [%ld]\n"</span>, tid2);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">}</span></span>
</span></span></code></div><small class="shcb-language" id="shcb-language-6"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>When we compile and run this test, we can see that both threads were created and print their IDs correctly. If we run the program several times in a row, we might notice that the threads are always created in order, but sometimes, the main writes its message before the thread and vice versa. This shows that each thread is indeed executing in parallel to the main thread, and not sequentially.</p>



<figure class="wp-block-image size-full"><img width="750" height="246" alt="Output of a program to test how threads work in preparation for the philosophers project." data-srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1.png 750w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1-300x98.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1-720x236.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1-580x190.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1-320x105.png 320w" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1.png" data-sizes="(max-width: 750px) 100vw, 750px" class="wp-image-3456 lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img width="750" height="246" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1.png" alt="Output of a program to test how threads work in preparation for the philosophers project." class="wp-image-3456" srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1.png 750w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1-300x98.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1-720x236.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1-580x190.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest1-en-1-320x105.png 320w" sizes="(max-width: 750px) 100vw, 750px"/></noscript></figure>



<h2><span class="ez-toc-section" id="managing_threads_shared_memory"></span>Managing Threads’ Shared Memory<span class="ez-toc-section-end"></span></h2>



<p>One of the greatest qualities of threads is that they all share their process’s memory. Each thread does have its own stack, but the other threads can very easily gain access to it with a simple pointer. What’s more, the heap and any open file descriptors are totally shared between threads.</p>



<p>This shared memory and the ease with which a thread can access another thread’s memory clearly also has its share of danger: it can cause nasty synchronization errors.</p>



<h3><span class="ez-toc-section" id="synchronization_errors"></span>Synchronization Errors<span class="ez-toc-section-end"></span></h3>



<p>Let’s go back to our previous example and modify it to see how the shared virtual memory of threads can cause issues. We will create two threads and give each of them a pointer towards a variable in the main containing an unsigned integer, <code>count</code>. Each thread will iterate a certain number of times (defined in <code>TIMES_TO_COUNT</code>) and increment the count at each iteration. Since there are two threads, we will of course expect the final count to be exactly twice <code>TIMES_TO_COUNT</code>.</p>


<pre class="wp-block-code has-small-font-size" aria-describedby="shcb-language-7" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><style>.hljs > mark.shcb-loc { background-color: #484b52; }</style><div><code class="hljs language-cpp shcb-code-table shcb-line-numbers"><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;pthread.h&gt;</span></span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">// Each thread will count TIMES_TO_COUNT times</span>
</span></span><mark class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> TIMES_TO_COUNT 21000</span>
</span></mark><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NC	<span class="hljs-meta-string">"\e[0m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> YELLOW	<span class="hljs-meta-string">"\e[33m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BYELLOW	<span class="hljs-meta-string">"\e[1;33m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> RED	<span class="hljs-meta-string">"\e[31m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> GREEN	<span class="hljs-meta-string">"\e[32m"</span></span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">void</span>	*<span class="hljs-title">thread_routine</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *data)</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-params"></span>{</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// Each thread starts here</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid;</span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>	*count; <span class="hljs-comment">// pointer to the variable created in main</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>	i;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	tid = pthread_self();</span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">	count = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)data;</span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// Print the count before this thread starts iterating:</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: Count at thread start = %u.%s\n"</span>,</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">		YELLOW, tid, *count, NC);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	i = <span class="hljs-number">0</span>;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">while</span> (i &lt; TIMES_TO_COUNT)</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	{</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">		<span class="hljs-comment">// Iterate TIMES_TO_COUNT times</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">		<span class="hljs-comment">// Increment the counter at each iteration</span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">		(*count)++;</span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">		i++;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	}</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// Print the final count when this thread</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// finishes its own count</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: Final count = %u.%s\n"</span>,</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">		BYELLOW, tid, *count, NC);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">return</span> (<span class="hljs-literal">NULL</span>); <span class="hljs-comment">// Thread ends here.</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">}</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-keyword">int</span>	<span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-params"></span>{</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid1;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid2;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Variable to keep track of the threads' counts:</span></span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>	count;</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"></span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	count = <span class="hljs-number">0</span>;</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Since each thread counts TIMES_TO_COUNT times and that</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// we have 2 threads, we expect the final count to be</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// 2 * TIMES_TO_COUNT:</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Expected count is %s%u%s\n"</span>, GREEN, </span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">					<span class="hljs-number">2</span> * TIMES_TO_COUNT, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Thread creation:</span></span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_create(&amp;tid1, <span class="hljs-literal">NULL</span>, thread_routine, &amp;count);</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Created first thread [%ld]\n"</span>, tid1);</span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_create(&amp;tid2, <span class="hljs-literal">NULL</span>, thread_routine, &amp;count);</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Created second thread [%ld]\n"</span>, tid2);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Thread joining:</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_join(tid1, <span class="hljs-literal">NULL</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Joined first thread [%ld]\n"</span>, tid1);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_join(tid2, <span class="hljs-literal">NULL</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Joined second thread [%ld]\n"</span>, tid2);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Final count evaluation:</span></span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">if</span> (count != (<span class="hljs-number">2</span> * TIMES_TO_COUNT))</span></span>
</span></mark><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">		<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sMain: ERROR ! Total count is %u%s\n"</span>, RED, count, NC);</span></span>
</span></mark><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">else</span></span></span>
</span></mark><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">		<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sMain: OK. Total count is %u%s\n"</span>, GREEN, count, NC);</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">}</span></span>
</span></span></code></div><small class="shcb-language" id="shcb-language-7"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>Output:</p>



<figure class="wp-block-image size-full"><img width="783" height="375" alt="Output of a test program for the philosophers project, showing the main problem with thread&#39;s shared memory: data race." data-srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1.png 783w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1-300x144.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1-768x368.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1-720x345.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1-580x278.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1-320x153.png 320w" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1.png" data-sizes="(max-width: 783px) 100vw, 783px" class="wp-image-3465 lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img width="783" height="375" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1.png" alt="Output of a test program for the philosophers project, showing the main problem with thread's shared memory: data race." class="wp-image-3465" srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1.png 783w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1-300x144.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1-768x368.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1-720x345.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1-580x278.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest3-en-1-320x153.png 320w" sizes="(max-width: 783px) 100vw, 783px"/></noscript></figure>



<p>Completely by chance, the first time we run the program, the result could be correct. But things aren’t always as they appear! The second time we run it, the result is totally incorrect. If we continue to run the program several more times in a row, we’ll even come to realize that it is wrong much more often than right… And it isn’t even predictably wrong: the final count varies a lot from one run to the next. So what is happening, here?</p>



<h3><span class="ez-toc-section" id="the_danger_of_data_races"></span>The Danger of Data Races<span class="ez-toc-section-end"></span></h3>



<p>If we examine the results closely, we can see that the final count is correct if and only if the first thread finishes counting before the second one starts. The minute their executions overlap, the result is wrong, and always less than the expected result.</p>



<p>So the problem is that both threads often access the same memory area at the same time. Let’s say the count is currently 10. Thread 1 reads the value 10. More accurately, it copies that value 10 to its register in order to manipulate it. Then, it adds 1 to get a result of 11. But before it can save the result in the memory area pointed to by the count variable, thread 2 reads the value 10. Thread 2 then increments it to 11 as well. Both threads then save their result and there we have it! Instead of incrementing the count once for each thread, they ended up only incrementing it by one in total… That’s why we’re loosing counts and our final result is so wrong.</p>



<p>This situation is called a <strong>data race</strong>. It happens when a program is subject to the progression or timing of other uncontrollable events. It is impossible to predict if the operating system will choose the correct sequencing for our threads.</p>



<p>Indeed, if we compile the program with the <code>-fsanitizer=thread</code> and <code>-g</code> options and then run it, like this:</p>


<pre class="wp-block-code"><div><code class="hljs">gcc -fsanitize=thread -g threads.c &amp;&amp; ./a.out</code></div></pre>


<p>We will get an alert: “WARNING: ThreadSanitizer: data race”.</p>



<p>So is there a way to stop a thread from reading a value while another one modifies it? Yes, thanks to mutexes!</p>



<h3><span class="ez-toc-section" id="what_is_a_mutex"></span>What is a Mutex ?<span class="ez-toc-section-end"></span></h3>



<p>A mutex (short for “<strong>mut</strong>ual <strong>ex</strong>clusion”) is a synchronization primitive. It is essentially a lock that allows us to regulate access to data and prevent shared resources being used at the same time.</p>



<p>We can think of a mutex as the lock of a bathroom door. One thread locks it to indicate that the bathroom is occupied. The other threads will just have to patiently stand in line until the door is unlocked before they can take their turn in the bathroom.</p>



<h4>Declaring a Mutex</h4>



<p>Thanks to the <code>&lt;pthread.h&gt;</code> header, we can declare a mutex type variable like this:</p>


<pre class="wp-block-code has-normal-font-size" aria-describedby="shcb-language-8" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-keyword">pthread_mutex_t</span>    mutex;</code></div><small class="shcb-language" id="shcb-language-8"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>Before we can use it, we first need to initialize it with the following function:</p>


<pre class="wp-block-code has-normal-font-size" aria-describedby="shcb-language-9" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">pthread_mutex_init</span><span class="hljs-params">(<span class="hljs-keyword">pthread_mutex_t</span> *mutex,
                        <span class="hljs-keyword">const</span> <span class="hljs-keyword">pthread_mutexattr_t</span> *mutexattr)</span></span>;</code></div><small class="shcb-language" id="shcb-language-9"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>There are two parameters to supply:</p>



<ul><li><strong>mutex</strong>: the pointer to a variable of <code>pthread_mutex_t</code> type.</li><li><strong>mutexattr</strong>: a pointer to specific attributes for the mutex. We will not worry about this parameter in this project, we can just say <code>NULL</code>.</li></ul>



<p>The <code>pthread_mutex_init</code> function only ever returns 0.</p>



<h4>Locking and Unlocking a Mutex</h4>



<p>Then, in order to lock and unlock our mutex, we need two other functions. Their prototypes are as follows:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-10" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">pthread_mutex_lock</span><span class="hljs-params">(<span class="hljs-keyword">pthread_mutex_t</span> *mutex)</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">pthread_mutex_unlock</span><span class="hljs-params">(<span class="hljs-keyword">pthread_mutex_t</span> *mutex)</span></span>;</code></div><small class="shcb-language" id="shcb-language-10"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>If the mutex is unlocked, <code><strong>pthread_mutex_lock</strong></code> locks it and the calling thread becomes its owner. In this case, the function ends immediately. However, if the mutex is already locked by another thread, <code>pthread_mutex_lock</code> suspends the execution of the calling thread until the mutex is unlocked.</p>



<p>The <code><strong>pthread_mutex_unlock</strong></code> function unlocks a mutex. The mutex to be unlocked is assumed to be locked by the calling thread, and the function only sets it to unlocked. Let’s be careful to note that this function does not check if the mutex is in fact locked and that the calling thread is actually its owner: a mutex could therefore be unlocked by a thread that did not lock it in the first place. We will need to be careful about arranging <code>pthread_mutex_lock</code> and <code>pthread_mutex_unlock</code> in our code.</p>



<p>Both of these functions return 0 for success and an error code otherwise.</p>



<h4>Destroying a Mutex</h4>



<p>When we no longer need a mutex, we should destroy it with the following function:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-11" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">pthread_mutex_destroy</span><span class="hljs-params">(<span class="hljs-keyword">pthread_mutex_t</span> *mutex)</span></span>;</code></div><small class="shcb-language" id="shcb-language-11"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>This function destroys an <em>unlocked</em> mutex, freeing whatever resources it might hold. In the LinuxThreads implementation of POSIX threads, no resources are associated with mutexes. In that case, <code>pthread_mutex_destroy</code> doesn’t do anything other than check that the mutex isn’t locked.</p>



<h4>Example Implementation of a Mutex</h4>



<p>We can now solve our previous example’s problem of incorrect final count by using a mutex. For this, we need to create a small structure that will contain our <code>count</code> variable and the mutex that will protect it. We can then pass this structure to our threads’ routines.</p>


<pre class="wp-block-code has-small-font-size" aria-describedby="shcb-language-12" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp shcb-code-table shcb-line-numbers"><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;pthread.h&gt;</span></span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">// Each thread will count TIMES_TO_COUNT times</span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> TIMES_TO_COUNT 21000</span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NC	<span class="hljs-meta-string">"\e[0m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> YELLOW	<span class="hljs-meta-string">"\e[33m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BYELLOW	<span class="hljs-meta-string">"\e[1;33m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> RED	<span class="hljs-meta-string">"\e[31m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> GREEN	<span class="hljs-meta-string">"\e[32m"</span></span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">// This structure contains the count as well as the mutex</span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">// that will protect the access to the variable.</span>
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">typedef</span>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">s_counter</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-class">{</span>
</span></span><mark class="shcb-loc"><span>	<span class="hljs-keyword">pthread_mutex_t</span>	count_mutex;
</span></mark><mark class="shcb-loc"><span>	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>	count;
</span></mark><span class="shcb-loc"><span>} t_counter;
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">void</span>	*<span class="hljs-title">thread_routine</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *data)</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-params"></span>{</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// Each thread starts here</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid;</span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">	t_counter	*counter; <span class="hljs-comment">// pointer to the structure in main</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>	i;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	tid = pthread_self();</span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">	counter = (t_counter *)data;</span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// Print the count before this thread starts iterating.</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// In order to read the value of count, we lock the mutex:</span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">	pthread_mutex_lock(&amp;counter-&gt;count_mutex);</span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: Count at thread start = %u.%s\n"</span>,</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">		YELLOW, tid, counter-&gt;count, NC);</span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">	pthread_mutex_unlock(&amp;counter-&gt;count_mutex);</span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">	i = <span class="hljs-number">0</span>;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">while</span> (i &lt; TIMES_TO_COUNT)</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	{</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">		<span class="hljs-comment">// Iterate TIMES_TO_COUNT times</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">		<span class="hljs-comment">// Increment the counter at each iteration</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">		<span class="hljs-comment">// Lock the mutex for the duration of the incrementation</span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">		pthread_mutex_lock(&amp;counter-&gt;count_mutex);</span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">		counter-&gt;count++;</span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">		pthread_mutex_unlock(&amp;counter-&gt;count_mutex);</span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">		i++;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	}</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// Print the final count when this thread finishes its</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-comment">// own count, without forgetting to lock the mutex:</span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">	pthread_mutex_lock(&amp;counter-&gt;count_mutex);</span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: Final count = %u.%s\n"</span>,</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">		BYELLOW, tid, counter-&gt;count, NC);</span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function">	pthread_mutex_unlock(&amp;counter-&gt;count_mutex);</span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">return</span> (<span class="hljs-literal">NULL</span>); <span class="hljs-comment">// Thread termine ici.</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">}</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-keyword">int</span>	<span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-params"></span>{</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid1;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid2;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Structure containing the threads' total count:</span></span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	t_counter	counter;</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// There is only on thread here (main thread), so we can safely</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// initialize count without using the mutex.</span></span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	counter.count = <span class="hljs-number">0</span>;</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Initialize the mutex :</span></span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_mutex_init(&amp;counter.count_mutex, <span class="hljs-literal">NULL</span>);</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Since each thread counts TIMES_TO_COUNT times and that</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// we have 2 threads, we expect the final count to be</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// 2 * TIMES_TO_COUNT:</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Expected count is %s%u%s\n"</span>, GREEN, </span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">					<span class="hljs-number">2</span> * TIMES_TO_COUNT, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Thread creation:</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_create(&amp;tid1, <span class="hljs-literal">NULL</span>, thread_routine, &amp;counter);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Created first thread [%ld]\n"</span>, tid1);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_create(&amp;tid2, <span class="hljs-literal">NULL</span>, thread_routine, &amp;counter);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Created second thread [%ld]\n"</span>, tid2);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Thread joining:</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_join(tid1, <span class="hljs-literal">NULL</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Joined first thread [%ld]\n"</span>, tid1);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_join(tid2, <span class="hljs-literal">NULL</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Joined second thread [%ld]\n"</span>, tid2);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Final count evaluation:</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// (Here we can read the count without worrying about</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// the mutex because all threads have been joined and</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// there can be no data race between threads)</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">if</span> (counter.count != (<span class="hljs-number">2</span> * TIMES_TO_COUNT))</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">		<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sMain: ERROR ! Total count is %u%s\n"</span>,</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">					RED, counter.count, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">else</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">		<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sMain: OK. Total count is %u%s\n"</span>,</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">					GREEN, counter.count, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Destroy the mutex at the end of the program:</span></span></span>
</span></span><mark class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_mutex_destroy(&amp;counter.count_mutex);</span></span>
</span></mark><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">}</span></span>
</span></span></code></div><small class="shcb-language" id="shcb-language-12"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>Let’s see if our result is still incorrect now:</p>



<figure class="wp-block-image size-full"><img width="762" height="375" alt="Output of a test program for the philosopher project, which demonstrates the usefulness of mutex to protect shared memory and avoid data races." data-srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en.png 762w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en-300x148.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en-720x354.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en-580x285.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en-320x157.png 320w" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en.png" data-sizes="(max-width: 762px) 100vw, 762px" class="wp-image-3463 lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img width="762" height="375" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en.png" alt="Output of a test program for the philosopher project, which demonstrates the usefulness of mutex to protect shared memory and avoid data races." class="wp-image-3463" srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en.png 762w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en-300x148.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en-720x354.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en-580x285.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest4-en-320x157.png 320w" sizes="(max-width: 762px) 100vw, 762px"/></noscript></figure>



<p>There! Our result is now always right, every time we run the program, even if the second thread starts counting before the first is finished.</p>



<h3><span class="ez-toc-section" id="beware_of_deadlocks"></span>Beware of Deadlocks<span class="ez-toc-section-end"></span></h3>



<p>However, mutexes can often provoke <strong>deadlocks</strong>. It’s a situation in which each thread waits for a resource held by another thread. For example, thread T1 acquired mutex M1 and is waiting for mutex M2. Meanwhile thread T2 acquired mutex M2 and is waiting for mutex M1. In this situation, the program stays pending in perpetuity and must be killed.</p>



<p>A deadlock can also happen when a thread is waiting for a mutex that it already owns!</p>



<p>Let’s try to demonstrate a deadlock. In this example, we will have two threads that need to lock two mutexes, <code>lock_1</code> and <code>lock_2</code> before being able to increment a counter. The routines of the two threads will be slightly different: the first thread will lock <code>lock_1</code> first, while thread 2 will start by locking <code>lock_2</code>…</p>


<pre class="wp-block-code has-small-font-size" aria-describedby="shcb-language-13" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp shcb-code-table shcb-line-numbers"><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;pthread.h&gt;</span></span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NC	<span class="hljs-meta-string">"\e[0m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> YELLOW	<span class="hljs-meta-string">"\e[33m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BYELLOW	<span class="hljs-meta-string">"\e[1;33m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> RED	<span class="hljs-meta-string">"\e[31m"</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> GREEN	<span class="hljs-meta-string">"\e[32m"</span></span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">typedef</span>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">s_locks</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-class">{</span>
</span></span><span class="shcb-loc"><span>	<span class="hljs-keyword">pthread_mutex_t</span>	lock_1;
</span></span><span class="shcb-loc"><span>	<span class="hljs-keyword">pthread_mutex_t</span>	lock_2;
</span></span><span class="shcb-loc"><span>	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>	count;
</span></span><span class="shcb-loc"><span>}	t_locks;
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">// The first thread invokes this routine:</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">void</span>	*<span class="hljs-title">thread_1_routine</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *data)</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-params"></span>{</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	t_locks		*locks;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	tid = pthread_self();</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	locks = (t_locks *)data;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: wants lock 1%s\n"</span>, YELLOW, tid, NC);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	pthread_mutex_lock(&amp;locks-&gt;lock_1);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: owns lock 1%s\n"</span>, BYELLOW, tid, NC);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: wants lock 2%s\n"</span>, YELLOW, tid, NC);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	pthread_mutex_lock(&amp;locks-&gt;lock_2);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: owns lock 2%s\n"</span>, BYELLOW, tid, NC);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	locks-&gt;count += <span class="hljs-number">1</span>;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: unlocking lock 2%s\n"</span>, BYELLOW, tid, NC);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	pthread_mutex_unlock(&amp;locks-&gt;lock_2);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: unlocking lock 1%s\n"</span>, BYELLOW, tid, NC);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	pthread_mutex_unlock(&amp;locks-&gt;lock_1);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: finished%s\n"</span>, YELLOW, tid, NC);</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-keyword">return</span> (<span class="hljs-literal">NULL</span>); <span class="hljs-comment">// The thread ends here.</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">}</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-comment">// The second thread invokes this routine:</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-keyword">void</span>	*<span class="hljs-title">thread_2_routine</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *data)</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-params"></span>{</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	t_locks		*locks;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	tid = pthread_self();</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	locks = (t_locks *)data;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: wants lock 2%s\n"</span>, YELLOW, tid, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_mutex_lock(&amp;locks-&gt;lock_2);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: owns lock 2%s\n"</span>, BYELLOW, tid, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: wants lock 1%s\n"</span>, YELLOW, tid, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_mutex_lock(&amp;locks-&gt;lock_1);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: owns lock 1%s\n"</span>, BYELLOW, tid, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	locks-&gt;count += <span class="hljs-number">1</span>;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: unlocking lock 1%s\n"</span>, BYELLOW, tid, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_mutex_unlock(&amp;locks-&gt;lock_1);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: unlocking lock 2%s\n"</span>, BYELLOW, tid, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	pthread_mutex_unlock(&amp;locks-&gt;lock_2);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sThread [%ld]: finished.%s\n"</span>, YELLOW, tid, NC);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">return</span> (<span class="hljs-literal">NULL</span>); <span class="hljs-comment">// The thread ends here.</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function">}</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"><span class="hljs-keyword">int</span>	<span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"><span class="hljs-params"></span>{</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid1;	<span class="hljs-comment">// ID of the first thread</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">pthread_t</span>	tid2;	<span class="hljs-comment">// ID of the second thread</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	t_locks		locks;	<span class="hljs-comment">// Structure containing 2 mutexes</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	locks.count = <span class="hljs-number">0</span>;</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Initialize both mutexes :</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	pthread_mutex_init(&amp;locks.lock_1, <span class="hljs-literal">NULL</span>);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	pthread_mutex_init(&amp;locks.lock_2, <span class="hljs-literal">NULL</span>);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Thread creation:</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	pthread_create(&amp;tid1, <span class="hljs-literal">NULL</span>, thread_1_routine, &amp;locks);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Created first thread [%ld]\n"</span>, tid1);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	pthread_create(&amp;tid2, <span class="hljs-literal">NULL</span>, thread_2_routine, &amp;locks);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Created second thread [%ld]\n"</span>, tid2);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Thread joining:</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	pthread_join(tid1, <span class="hljs-literal">NULL</span>);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Joined first thread [%ld]\n"</span>, tid1);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	pthread_join(tid2, <span class="hljs-literal">NULL</span>);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Main: Joined second thread [%ld]\n"</span>, tid2);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Final count evaluation:</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">if</span> (locks.count == <span class="hljs-number">2</span>)</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">		<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sMain: OK. Total count is %d\n"</span>, GREEN, locks.count);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">else</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">		<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%sMain: ERROR ! Total count is %u\n"</span>, RED, locks.count);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-comment">// Mutex destruction:</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	pthread_mutex_destroy(&amp;locks.lock_1);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	pthread_mutex_destroy(&amp;locks.lock_2);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">	<span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">}</span></span></span>
</span></span></code></div><small class="shcb-language" id="shcb-language-13"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>As we can see in the following output, most of the time, there is no problem with this configuration because the first thread has a small head start on the second one. But sometimes, both threads lock their first mutexes exactly at the same time, in which case the program stays blocked because the threads are caught in a deadlock.</p>



<figure class="wp-block-image size-full"><img width="789" height="486" alt="Output of a test for the philosopher project, which shows a thread deadlock caused by mutexes." data-srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en.png 789w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en-300x185.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en-768x473.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en-720x443.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en-580x357.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en-320x197.png 320w" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en.png" data-sizes="(max-width: 789px) 100vw, 789px" class="wp-image-3469 lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img width="789" height="486" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en.png" alt="Output of a test for the philosopher project, which shows a thread deadlock caused by mutexes." class="wp-image-3469" srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en.png 789w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en-300x185.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en-768x473.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en-720x443.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en-580x357.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-threadtest5-en-320x197.png 320w" sizes="(max-width: 789px) 100vw, 789px"/></noscript></figure>



<p>Studying this result, we can clearly see that the first thread locked <code>lock_1</code> and the second locked <code>lock_2</code>. The first thread now wants to lock <code>lock_2</code> and the second wants <code>lock_1</code>, but neither have any way of getting those mutexes. They are deadlocked.</p>



<h3><span class="ez-toc-section" id="dealing_with_deadlocks"></span>Dealing with Deadlocks<span class="ez-toc-section-end"></span></h3>



<p>There are several ways to deal with deadlocks like these. Among other things, we can:</p>



<ul><li>ignore them, but only if we can prove that they will never happen. For example when the time intervals between resource requests are very long and far between.</li><li>correct them when they happen by killing a thread or by redistributing resources, for example.</li><li>prevent and correct them before they happen.</li><li>avoid them by imposing a strict order for resource acquisition. This is the solution to our previous example: the threads should both ask for <code>lock_1</code> first.</li><li>avoid them by forcing a thread to release a resource before asking for new ones, or before renewing its request.</li></ul>



<p>We will see later what kind of deadlocks we should watch out for in our philosophers project and some ways to manage them.</p>



<h2><span class="ez-toc-section" id="managing_time_in_the_philosophers_project"></span>Managing Time in the Philosophers Project<span class="ez-toc-section-end"></span></h2>



<p>The concept of time is very important in the philosophers project. Philosophers have a certain amount of time to eat and sleep, and die if they don’t manage to get a meal within a certain time frame.</p>



<h3><span class="ez-toc-section" id="the_gettimeofday_function"></span>The Gettimeofday Function<span class="ez-toc-section-end"></span></h3>



<p>First of all, we need to be able to get the operating system’s temporal values. For that, we need the system library <code>&lt;sys/time.h&gt;</code>. It contains the <code><strong>gettimeofday</strong></code> function, that has the following prototype:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-14" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">gettimeofday</span><span class="hljs-params">(struct timeval *tv, struct timezone *tz)</span></span>;</code></div><small class="shcb-language" id="shcb-language-14"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>The parameters we must supply are the following:</p>



<ul><li><strong>tv</strong>: a <code>timeval</code> type data structure that contains the number of seconds (<code>tv_sec</code>) and the number of microseconds (<code>tv_usec</code>) that have passed since the 1st of January 1970, a date chosen for technical reasons by the creators of the Unix operating system.</li><li><strong>tz</strong>: a <code>timezone</code> type structure. Since the use of this structure is now obsolete and that we don’t need it for the philosophers project in any case, we will simply put <code>NULL</code> here.</li></ul>



<p>When we call this function, it will fill the <code>timeval</code> structure and return 0 if the call was successful, or -1 if there was an error.</p>



<p>In order to calculate the time in milliseconds as required by the subject of the philosophers project, we need to apply the following formula after collecting the data into a <code>tv</code> structure with <code>gettimeofday</code>:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-15" data-shcb-language-name="plaintext" data-shcb-language-slug="plaintext"><div><code class="hljs language-plaintext">(tv.tv_sec * 1000) + (tv.tv_usec / 1000)</code></div><small class="shcb-language" id="shcb-language-15"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">plaintext</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">plaintext</span><span class="shcb-language__paren">)</span></small></pre>


<p>Indeed, the equivalence between seconds, milliseconds and microseconds is as follows:</p>



<figure class="wp-block-table"><table><tbody><tr><td><strong>Seconds (s)</strong></td><td><strong>Milliseconds (ms)</strong></td><td><strong>Microseconds (µs)</strong></td></tr><tr><td>1</td><td>1 000</td><td>1 000 000</td></tr><tr><td>0.001</td><td>1</td><td>1 000</td></tr><tr><td>0.000001</td><td>0.001</td><td>1</td></tr><tr><td>1<sup>0</sup> seconds</td><td>1<sup>-3</sup> seconds</td><td>1<sup>-9</sup> seconds</td></tr></tbody></table></figure>



<h3><span class="ez-toc-section" id="the_usleep_function"></span>The Usleep Function<span class="ez-toc-section-end"></span></h3>



<p>The <strong><code>usleep</code></strong> function in the <code>&lt;unistd.h&gt;</code> library allows us to stop the execution of the calling thread for a certain number of microseconds. Its prototype is:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-16" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">usleep</span><span class="hljs-params">(<span class="hljs-keyword">useconds_t</span> usec)</span></span>;</code></div><small class="shcb-language" id="shcb-language-16"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>Let’s take note that this function guarantees the suspension of execution for <em>at least</em> <strong>usec</strong> microseconds. This means that the suspension might be longer depending on the operating system’s activity and its granularity.</p>



<p>The <code>usleep</code> function returns 0 for success and -1 for failure.</p>



<h3><span class="ez-toc-section" id="example_of_time_display_in_milliseconds"></span>Example of Time Display in Milliseconds<span class="ez-toc-section-end"></span></h3>



<p>Let’s create a little program to test the display of time in milliseconds. It will first save the start time in milliseconds at the start of the program. Every 100 ms, it will print the time since the start of the program. After 2000 ms, it stops.</p>


<pre class="wp-block-code has-small-font-size" aria-describedby="shcb-language-17" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp shcb-code-table shcb-line-numbers"><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/time.h&gt;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">// Function that returns the current time since the </span>
</span></span><span class="shcb-loc"><span><span class="hljs-comment">// 1st of January 1970 in milliseconds</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">time_t</span>	<span class="hljs-title">get_time_in_ms</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-params"></span>{</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function">	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">timeval</span>	<span class="hljs-title">tv</span>;</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class">	gettimeofday(&amp;tv, <span class="hljs-literal">NULL</span>);</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class">	<span class="hljs-keyword">return</span> ((tv.tv_sec * <span class="hljs-number">1000</span>) + (tv.tv_usec / <span class="hljs-number">1000</span>));</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class">}</span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function"><span class="hljs-keyword">int</span>	<span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function"><span class="hljs-params"></span>{</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	<span class="hljs-keyword">time_t</span>	start_time;</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	<span class="hljs-keyword">time_t</span>	end_time;</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	<span class="hljs-keyword">time_t</span>	time;</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function"></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	start_time = get_time_in_ms();</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	end_time = start_time + <span class="hljs-number">2000</span>;</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	time = get_time_in_ms();</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Time in ms = %ld. Time since start = %ld\n"</span>, time, time - start_time);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	<span class="hljs-keyword">while</span> (get_time_in_ms() &lt; end_time)</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	{</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">		usleep(<span class="hljs-number">100</span> * <span class="hljs-number">1000</span>); <span class="hljs-comment">// Suspend for 100 milliseconds</span></span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">		time = get_time_in_ms();</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">		<span class="hljs-built_in">printf</span>(<span class="hljs-string">"Time in ms = %ld. Time since start = %ld\n"</span>,</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">						time, time - start_time);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	}</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">	<span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);</span></span></span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-class"><span class="hljs-function">}</span></span></span>
</span></span></code></div><small class="shcb-language" id="shcb-language-17"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>Output:</p>



<figure class="wp-block-image size-full"><img width="693" height="381" alt="Output of a test program for the philosophers project that shows how to print the time in milliseconds since the start of the program." data-srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-timetest1-en.png 693w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-timetest1-en-300x165.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-timetest1-en-580x319.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-timetest1-en-320x176.png 320w" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-timetest1-en.png" data-sizes="(max-width: 693px) 100vw, 693px" class="wp-image-3473 lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img width="693" height="381" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-timetest1-en.png" alt="Output of a test program for the philosophers project that shows how to print the time in milliseconds since the start of the program." class="wp-image-3473" srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-timetest1-en.png 693w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-timetest1-en-300x165.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-timetest1-en-580x319.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philo-timetest1-en-320x176.png 320w" sizes="(max-width: 693px) 100vw, 693px"/></noscript></figure>



<p>We can see here that a small delay sets in and increases over time because of the <code>usleep</code> function. We will have to take this into account and try to rectify this problem in our philosophers project so that our timestamps are as precise as possible.</p>



<h2><span class="ez-toc-section" id="strategies_for_the_philosophers_project"></span>Strategies for the Philosophers Project<span class="ez-toc-section-end"></span></h2>



<p>For the mandatory part of the philosophers project, we get two clues concerning the structure of our program:</p>



<ul><li>Each philosopher must be a thread.</li><li>Each fork must be protected by a mutex.</li></ul>



<p>On top of that, we know that we will no doubt need at least one structure to manage the variables unique to each philosopher and another to manage the general variables of the program. Among those, we will probably need at least one mutex to protect the message-printing by philosophers so that their messages don’t get scrambled, and an array of mutexes for the forks.</p>



<p>That’s already a good start for the project: we can start parsing the arguments and initializing our structures. Next, we can create our philosophers’ basic eat-sleep-think routines. Then, we need to devise some strategies to detect the death of a philosopher and to handle the forks in an optimal way to keep our philosophers alive…</p>



<h3><span class="ez-toc-section" id="detecting_death_in_the_philosophers_project"></span>Detecting Death in the Philosophers Project<span class="ez-toc-section-end"></span></h3>



<p>Each philosopher must be a thread, but not all threads must be philosophers! When we create the philosopher threads, nothing is stopping us from creating an extra thread. That supervisor thread will have only one goal: check the status of each philosopher in a loop. If one of the philosophers is about to die, the supervisor can then stop the simulation. Likewise if all the philosophers have eaten the number of times indicated at the start of the program.</p>



<p>In order to indicate the status of the simulation, we could create a boolean variable protected by a mutex. Only the supervisor thread could change this variable. But the philosopher threads would be able to read it to check the status of the simulation before and during each of their actions, and before printing a status update message. If this variable is equal to 1 for example, the threads will see that they can safely continue their instruction sequence. However, if it is equal to 0, they must immediately stop what they are doing because the simulation must end as quickly as possible.</p>



<p>One important thing to note: it’s a little counter-intuitive, but <strong>a philosopher can starve while he is eating</strong>! The subject indicates that a philosopher dies if he has not eaten <code>time_to_die</code> since the start of the simulation or since<em> the start</em> of his last meal. This implies that he can die while eating, for example in the case where the <code>time_to_eat</code> is greater than the <code>time_to_die</code>.</p>



<p>If someone dies, we must print the message “X died” in less than 10 ms after the actual death. No other message can follow this announcement and the simulation must end immediately.</p>



<h3><span class="ez-toc-section" id="the_usleep_problem_in_the_philosophers_project"></span>The Usleep Problem in the Philosophers Project<span class="ez-toc-section-end"></span></h3>



<p>The <code>usleep</code> function enables us to suspend the execution of a philosopher thread for the required time to eat, sleep or think. The first thing to remember is that <code>usleep</code> measures time in microseconds. In order to indicate a time in the order of milliseconds, we will have to multiply it by 1000:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-18" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-comment">// To suspend the thread for time_to_eat</span>
<span class="hljs-comment">// we need to multiply by 1000 to get the </span>
<span class="hljs-comment">// time in microseconds for usleep:</span>
usleep(time_to_sleep * <span class="hljs-number">1000</span>);</code></div><small class="shcb-language" id="shcb-language-18"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>But the simulation of our philosophers program might end in the middle of a meal or a nap. So we will probably want to check if the simulation has stopped or not during this suspension time. If the simulation has stopped, we need to be able to wake the thread up so that it can end as quickly as possible, especially if the <code>time_to_sleep</code> or <code>time_to_eat</code> is very long. The problem is that there is no way to interrupt <code>usleep</code>.</p>



<p>So we’ll probably want to create our own function to suspend a thread, one that can periodically check the status of the simulation. It might be constructed something like this:</p>


<pre class="wp-block-code has-small-font-size" aria-describedby="shcb-language-19" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-comment">// Parameters of philo_sleep:</span>
<span class="hljs-comment">//     table = pointer to the variables of the "table", i.e. the program variables</span>
<span class="hljs-comment">//             like the flag indicating the end of the simulation</span>
<span class="hljs-comment">//     sleep_time = the time in milliseconds that the thread must be suspended for,</span>
<span class="hljs-comment">//                  typically time_to_sleep or time_to_eat</span>
<span class="hljs-function"><span class="hljs-keyword">void</span>	<span class="hljs-title">philo_sleep</span><span class="hljs-params">(t_table *table, <span class="hljs-keyword">time_t</span> sleep_time)</span>
</span>{
	<span class="hljs-comment">// Variable to measure when the philosopher thread must resume:</span>
	<span class="hljs-keyword">time_t</span>	wake_up;

	wake_up = get_time_in_ms() + sleep_time;
        <span class="hljs-comment">// Loop as long as it's not wake up time:</span>
	<span class="hljs-keyword">while</span> (get_time_in_ms() &lt; wake_up)
	{
		<span class="hljs-comment">// Check if the simulation has stopped. If it has,</span>
		<span class="hljs-comment">// stop the loop (and this function) immediately</span>
		<span class="hljs-comment">// to continue thread execution:</span>
		<span class="hljs-keyword">if</span> (has_simulation_stopped(table))
			<span class="hljs-keyword">break</span> ;
		<span class="hljs-comment">// If the simulation is still going, usleep for a short time:</span>
		usleep(<span class="hljs-number">100</span>);
	}
}</code></div><small class="shcb-language" id="shcb-language-19"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<h3><span class="ez-toc-section" id="handling_forks_in_the_philosophers_project"></span>Handling Forks in the Philosophers Project<span class="ez-toc-section-end"></span></h3>



<p>The greatest challenge in the philosophers project is managing the forks. As we’ve seen previously, there is one fork between each philosopher and a philosopher needs two forks to be able to eat. If there is only one philosopher, there will only be one fork on the table, which means that he will inevitably starve to death.</p>



<p>The philosophers must never duplicate forks when they grab them. This is partly why the subject of the philosophers project requires that we “protect the forks state with a mutex for each of them”. This can mean one of two things :</p>



<ul><li>the forks are themselves mutexes.</li><li>the forks are variables protected by mutexes.</li></ul>



<p>This choice is up to each student’s interpretation since the subject does not elaborate on this point.</p>



<p>Since the forks are placed between each philosopher, philosophers must take the forks on either side of their own plates, not the ones on the other side of the table.</p>



<h4>An Immediate Deadlock</h4>



<p>The subject of the philosophers project does not allow us to use any of the pthread functions that would allow us to test whether a mutex is in use or not. So a philosopher cannot check in advance which one of his two forks is free to inform his choice of which fork to take first. This means that if his first fork is unavailable, the philosopher won’t be able to try to take his second fork instead. He will stay suspended until his first fork is firmly in hand before attempting to take his second fork.</p>



<p>If every philosopher pounces on his right hand fork-mutex at once for example, we will have an immediate deadlock, as illustrated here.</p>



<figure class="wp-block-image size-large"><img width="1024" height="1024" alt="Illustration of an immediate deadlock that can happen in the 42 project philosophers. All the philosophers took their right fork at the same time and all are waiting for their left fork." data-srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-1024x1024.png 1024w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-300x300.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-150x150.png 150w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-768x768.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-720x720.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-580x580.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-320x320.png 320w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2.png 1200w" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-1024x1024.png" data-sizes="(max-width: 1024px) 100vw, 1024px" class="wp-image-3169 lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img width="1024" height="1024" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-1024x1024.png" alt="Illustration of an immediate deadlock that can happen in the 42 project philosophers. All the philosophers took their right fork at the same time and all are waiting for their left fork." class="wp-image-3169" srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-1024x1024.png 1024w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-300x300.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-150x150.png 150w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-768x768.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-720x720.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-580x580.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2-320x320.png 320w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philosophers-deadlock-2.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px"/></noscript><figcaption>Immediate deadlock! No one can eat…</figcaption></figure>



<p>We’ve seen that it is impossible to predict the order in which the operating system will execute each thread. This immediate deadlock will not happen every time we run the program, but it will happen often enough to cause problems.</p>



<p>We need to find a solution to eliminate the possibility of this deadlock. And that solution might well be a combination of the ones described below.</p>



<h4>Setting the Fork Back on the Table</h4>



<p>The obvious solution to a deadlock like this is to make a philosopher set his fork back down if he can’t get his second fork. But how can we interrupt a mutex’s thread suspension?</p>



<p>Of course, we can’t. What we can do however, is create a small structure for our forks, which will contain a boolean variable indicating the status of the fork (in use or not) and a mutex to protect it. Something like this, perhaps:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-20" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">s_fork</span>
{</span>
	<span class="hljs-keyword">pthread_mutex_t</span>	fork_lock;
	<span class="hljs-keyword">bool</span>		in_use;
}	t_fork;</code></div><small class="shcb-language" id="shcb-language-20"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>A philosopher taking a fork will have to lock the mutex, change the value of the <code>in_use</code> variable to 1 and unlock the mutex again. When attempting to take his second fork, he can lock its mutex, check the variable to see if it is available. If not, he’ll unlock the mutex and release his first fork by setting the first fork’s variable back to 0. Then, he will wait a little before trying to take both forks again. In the meantime, his neighbor can use that first fork to eat if need be. This system avoids most deadlock possibilities. </p>



<p>Of course, to avoid spamming messages like “X has taken a fork”, they should only be printed when the philosopher actually has both forks in hand.</p>



<p>The main objection to this method is the fact that the subject of the philosopher project explicitly forbids communication between philosophers. From a technical perspective, this solution doesn’t require any communication between a philosopher and his neighbor, only between the philosopher and the forks. But would a philosopher that didn’t know anything about what is happening around him really have the instinct to put his fork back down on the table if he couldn’t get his second fork? That’s a question that will have to be debated during the evaluation if this method is used.</p>



<h4>Right-Handed and Left-Handed Philosophers</h4>



<p>The problem with the immediate deadlock is that the philosophers all grab their right fork first. Yet a philosopher’s right fork is also his neighbor’s left fork. If we designate one out of two philosophers as left-handed, that should solve the immediate deadlock issue.</p>



<figure class="wp-block-image size-large"><img width="1024" height="1024" alt="Illustration of a solution for the 42 project philosophers.  Even-numbered philosophers are right handed, while odd-numbered philosophers take their left fork first." data-srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-1024x1024.png 1024w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-300x300.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-150x150.png 150w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-768x768.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-720x720.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-580x580.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-320x320.png 320w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork.png 1200w" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-1024x1024.png" data-sizes="(max-width: 1024px) 100vw, 1024px" class="wp-image-3388 lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img width="1024" height="1024" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-1024x1024.png" alt="Illustration of a solution for the 42 project philosophers.  Even-numbered philosophers are right handed, while odd-numbered philosophers take their left fork first." class="wp-image-3388" srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-1024x1024.png 1024w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-300x300.png 300w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-150x150.png 150w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-768x768.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-720x720.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-580x580.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork-320x320.png 320w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/philos-left-right-fork.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px"/></noscript><figcaption>One of every two philosophers is left-handed. This avoids an immediate deadlock.</figcaption></figure>



<p>In this illustration, philosophers that have an even-numbered ID are right-handed and will therefore try to take their right fork first. The opposite is true for the odd-numbered philosophers, who are left-handed and try to pick up their left fork first. Here, philosopher 0 is right handed and takes his right fork, f0. Philosopher 1, being left-handed, first takes his left fork, f2. This forces right-handed philosopher 2 to wait since his right fork, f2, is in use. And left-handed philosopher 3 grabs his left fork f4 before right handed philosopher 4, who must now wait.</p>



<p>Thanks to this distinction between right and left-handed philosophers, there is no possibility of immediate deadlock. Philosophers 0 and 3 will probably eat first, then philosophers 4 and 1, followed by philosopher 2. It’s also possible philosophers 1 and 3 will eat first, followed by 0 and 2, and finally 4. In any case, deadlocks are avoided.</p>



<p>In the case of an ever number of philosophers, this solution is very efficient and produces reliable results. However, a problem surfaces quickly if there is an odd number of philosophers around the table…</p>



<h5>Wrongful Deaths with an Uneven Number of Philosophers</h5>



<p>Just about once every three or four times, a philosopher dies when he shouldn’t. Another philosopher takes his fork, and so his meal, before he gets a chance to. These unreliable results are simply due to the thread execution order that the operating system chose, which, of course, has no concept of which philosopher needs to eat before another.</p>


<div class="mks_toggle">
			<div class="mks_toggle_heading">See a wrongful death output example<i class="fa fa-plus"></i><i class="fa fa-minus"></i></div>
				<div class="mks_toggle_content">



<p>Here is an example of bad output with only the right and left-handed philosopher method. With these arguments (5 philosophers, 1200 ms as time_to_die, 300 ms to eat, 300 ms to sleep, and 2 mals to eat), every philosopher should eat at least two meals and no one should die. Here though, someone did die…</p>



<figure class="wp-block-image size-full"><img width="793" height="868" alt="Erroneous result of a test of the 42 school project philosophers, where there are right and left-handed philosophers. A philosopher has dies at 1500 milliseconds even though none should die." data-srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31.png 793w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31-274x300.png 274w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31-768x841.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31-720x788.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31-580x635.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31-320x350.png 320w" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31.png" data-sizes="(max-width: 793px) 100vw, 793px" class="wp-image-3346 lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img width="793" height="868" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31.png" alt="Erroneous result of a test of the 42 school project philosophers, where there are right and left-handed philosophers. A philosopher has dies at 1500 milliseconds even though none should die." class="wp-image-3346" srcset="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31.png 793w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31-274x300.png 274w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31-768x841.png 768w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31-720x788.png 720w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31-580x635.png 580w, https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/Screenshot-from-2022-07-14-13-39-31-320x350.png 320w" sizes="(max-width: 793px) 100vw, 793px"/></noscript></figure>


</div>
			</div>



<p>The slide below is a direct transcription of the erroneous result above. Arrows to the left and right of the image allow us to move forwards and backwards in time. Below each image are notes to help us examine each step of this simulation’s evolution.</p>


<div class="mks_separator" style="border-bottom: 2px solid;"></div>



		<!-- MasterSlider -->
		<div id="P_MS62d5ce238521c" class="master-slider-parent msl ms-parent-id-5" style="max-width:800px;">

			
			<!-- MasterSlider Main -->
			<div id="MS62d5ce238521c" class="master-slider ms-skin-light-4">
				 				 
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-06.png">

					<div class="ms-info"><p style="text-align: left;">In this example, there are five philosophers. The time_to_die is 12, the time_to_eat and the time_to_sleep is 3. Even-numbered philosophers are right-handed and odd-numbered philosophers are left-handed.</p></div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-09.png">

					<div class="ms-info"><p style="text-align: left;">Philosophers 0 and 2 are right-handed. Therefore, they take their right forks, f0 and f2 respectively, while philosopher 3 is left-handed and takes fork f4. Since philosopher 1's left fork and philosopher 4's right fork are busy, those two will wait to be able to eat.</p></div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-11.png">

					<div class="ms-info"><p style="text-align: left;">Philosopher 1 starts eating, as well as philosopher 3, who managed to grab fork f3 before philosopher 2, who will now have to wait his turn.</p></div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-12.png">

					<div class="ms-info">Times advances. Philosophers 0 and 3 are eating, while philosophers 1, 2 and 4 wait for their forks.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-13.png">

					<div class="ms-info"><p style="text-align: left;">Times advances. Philosophers 0 and 3 are still eating, while philosophers 1, 2 and 4 wait patiently.</p></div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-14.png">

					<div class="ms-info"><p style="text-align: left;">Times ticks up. Philosophers 0 and 3 are done eating and set their forks down before taking their nap. Philosopher 2 is still holding his right fork.</p></div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-16.png">

					<div class="ms-info">Philosophers 2 and 4 grab their napping neighbors' forks. Philosopher 1 still hasn't eaten and must wait some more for his left fork, presently in use by philosopher 2.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-17.png">

					<div class="ms-info"><p style="text-align: left;">Time ticks by. Philosophers 2 and 4 are eating while philosophers 0 and 3 sleep. Philosopher 1 waits patiently for his fork.</p></div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-18.png">

					<div class="ms-info"><p style="text-align: left;">Time advances. Philosophers 2 and 4 are still devouring their meal while philosophers 0 and 3 nap. Philosopher 1 is still waiting for his fork.</p></div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-19.png">

					<div class="ms-info">Time ticks by. Philosophers 2 and 4 are done with their meal and set their forks down again before falling asleep. Philosophers 0 and 3 are awake. Philosopher 1 readies himself to pounce on the fork he's been longing for.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-21.png">

					<div class="ms-info">Philosopher 1 finally got his left fork but didn't have time to grab his right fork: philosopher 0 was quicker. He will now have to wait a little longer while philosophers 0 and 3 eat. Philosophers 2 and 4 are presently sleeping.<br>This moment is not going to be fatal to philosopher 1, but we can observe the same issue reappear over and over in this program, and it is sometimes fatal.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-22.png">

					<div class="ms-info">Time ticks by. Philosophers 0 and 3 enjoy their meal while philosopher 1's stomach growls. Philosophers 2 and 4 are sleeping peacefully.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-23.png">

					<div class="ms-info">Time ticks by. Philosophers 0 and 3 are still eating while philosopher 1 is starving. Philosophers 2 and 4 are still sound asleep.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-24.png">

					<div class="ms-info">Time advances. Philosophers 0 and 3 are full and fall asleep right away while philosophers 2 and 4 are waking up. Desperate philosopher 1 is ready to kill for his right fork.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-26.png">

					<div class="ms-info">Well, it wasn't as hard as philosopher 1 anticipated to grab his right fork since his neighbor was sleeping. He is now happily eating in the company of philosopher 4. Philosophers 0 and 3 are sleeping. Philosopher 2 is getting hungry, but philosopher 1 was holding his right fork firmly in hand when he woke up. He just needs a little patience.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-27.png">

					<div class="ms-info">Time ticks by. Philosophers 1 and 4 eat in peace while their neighbors 0 and 3 sleep. Philosopher 2 is waiting for his fork.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-28.png">

					<div class="ms-info">Time ticks by. Philosophers 1 and 4 are still masticating while their neighbors 0 and 3 dream. Philosopher 2 is now starving...</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-29.png">

					<div class="ms-info">Time passes. Philosophers 1 and 3 fall asleep after their meal, while philosophers 0 and 3 are waking up. Philosopher 2 is absolutely starving and must grab both of his forks and eat now if he is to survive.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-31.png">

					<div class="ms-info">Philosopher 2 takes his right fork but philosopher 3 beats him to it! Oblivious, philosopher 3 just signed philosopher 2's death warrant. He begins his meal in the company of philosopher 0 while philosophers 1 and 4 are sleeping.<br>This moment, where a philosopher takes a fork too early at the expense of another, happened earlier with philosopher 1. It was not fatal then but it is this time.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-32.png">

					<div class="ms-info">Time ticks by. Philosopher 2 will starve soon. Oblivious, philosophers 0 and 3 eat while philosophers 1 and 4 sleep.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-33.png">

					<div class="ms-info">Time advances. Philosopher 2 is on his death bed. Still oblivious, philosophers 0 and 3 keep eating while philosophers 1 and 4 keep sleeping.</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>
				<div class="ms-slide" data-delay="3" data-fill-mode="fit">
					<img src="./Philosophers 01_ Threads and Mutexes - codequoi_files/blank.gif" alt="" title="" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/philo-fork-gif-35.png">

					<div class="ms-info">Philosophers 0 and 3 finish their meals and fall asleep. Philosophers 1 and 4 wake up to find the lifeless corpse of their colleague, philosopher 2, who starved to death. In a parallel universe, this death might have been prevented!</div>


	<div class="ms-thumb"><div class="ms-tab-context"><div class="&quot;ms-tab-context&quot;"></div></div>
</div>
				</div>

			</div>
			<!-- END MasterSlider Main -->

			 
		</div>
		<!-- END MasterSlider -->

		<script>
		(function ( $ ) {
			"use strict";

			$(function () {
				var masterslider_521c = new MasterSlider();

				// slider controls
				masterslider_521c.control('arrows'     ,{ autohide:false, overVideo:true  });				masterslider_521c.control('bullets'    ,{ autohide:true, overVideo:true, dir:'h', align:'bottom' , margin:10  });

				masterslider_521c.control('slideinfo'  ,{ autohide:false, overVideo:true, dir:'h', align:'bottom',inset:false , margin:10   });
				// slider setup
				masterslider_521c.setup("MS62d5ce238521c", {
						width           : 800,
						height          : 800,
						minHeight       : 0,
						space           : 0,
						start           : 1,
						grabCursor      : false,
						swipe           : true,
						mouse           : false,
						layout          : "boxed",
						wheel           : true,
						autoplay        : false,
						instantStartLayers:false,
						loop            : false,
						shuffle         : false,
						preload         : 0,
						heightLimit     : true,
						autoHeight      : false,
						smoothHeight    : true,
						endPause        : false,
						overPause       : false,
						fillMode        : "fill",
						centerControls  : true,
						startOnAppear   : false,
						layersMode      : "center",
						hideLayers      : false,
						fullscreenMargin: 0,
						speed           : 90,
						dir             : "h",
						parallaxMode    : 'swipe',
						view            : "fade"
				});

				
				window.masterslider_instances = window.masterslider_instances || [];
				window.masterslider_instances.push( masterslider_521c );
			 });

		})(jQuery);
		</script>




<div class="mks_separator" style="border-bottom: 2px solid;"></div>



<p>If we with to use this right and left-handed method for philosophers, we will need to find a solution to the problem of the uneven number of philosophers. We could perhaps think of a way to better stagger each philosopher’s meals.</p>



<h4>Delaying Certain Philosopher Threads</h4>



<p>Another solution to avoid an immediate deadlock is to create a small delay between threads at the start. This gives a small head start to the philosophers that go first, enough to grab their forks before the others.</p>



<h5>A Delay Between Each Thread’s Creation</h5>



<p>For example, we could add a small <code>usleep</code> after creating each thread to give the first philosopher a head start on the second one and so on.</p>



<p>The thing is, our philosopher program must be able to simulate up to 200 philosophers without creating too much of a delay in the timestamps it prints out. If we add a 1 millisecond delay at the launch of each philosopher, the 200<sup>th</sup> philosopher will start at the 200<sup>th</sup> millisecond, which could bring about a premature death. Plus, if we have a supervisor thread to detect a philosopher’s death, it might consider a not-yet-created philosopher thread as dead! And we can’t apply the same 200 ms delay to the supervisor thread without running the risk of missing some deaths. For example, if there are 200 philosophers and that the <code>time_to_die</code> is 1 ms, we need to be able to detect the death immediately, not 200 ms later.</p>



<h5>A Delay at the Beginning of Odd-Numbered Philosophers’ Routines</h5>



<p>So what if we added a small <code>usleep</code> only for the philosopher threads that have an odd-numbered ID? That would allow even-numbered philosophers to eat first and odd-numbered philosophers would have to wait their turn. This also wouldn’t create a large time lag.</p>



<p>This solution is very effective in a great majority of cases. However, we must still choose an appropriate time delay. We can’t make the odd-numbered philosophers wait for <code>time_to_eat</code> because if <code>time_to_eat</code> happens to be 0, meaning philosophers eat instantaneously, we will end up with the same initial deadlock we are trying to avoid, especially if <code>time_to_sleep</code> is also 0! We’d better define a small value like 1 or 2 milliseconds. That would be enough time to let the first batch of philosophers take both of their forks.</p>



<p> We still need to be careful with this solution if there is an odd number of philosophers. Just like the right and left-handed philosopher solution described above, one might die prematurely because his neighbors repeatedly steal his meals… </p>



<h3><span class="ez-toc-section" id="giving_the_philosophers_time_to_think"></span>Giving the Philosophers Time to Think<span class="ez-toc-section-end"></span></h3>



<p>Our philosophers program does not take an argument corresponding to the length of time each philosopher spends thinking. The thinking routine could very well consist of nothing more than printing the status “X is thinking” and moving on directly to fork-hunting in order to eat.</p>



<p>But the subject does not explicitly forbid us from calculating a small period of reflection for each philosopher. Shouldn’t a philosopher have time to think about deeper things than the availability of his forks ?</p>



<h4>Why Calculate a Time to Think?</h4>



<p>Calculating this time to think is very useful to avoid a philosopher eating too often. If he does, he might deprive his neighbor of several meals in a row, which ends up killing him. A time to think allows time for the hungriest philosophers to pick up forks, and doesn’t require any actual communication between philosophers. Indeed, the calculation for this time to think is strictly personal, requiring no information from any other philosopher. It is simply the calculation of when this philosopher will get hungry again.</p>



<h4>How to Calculate a Time to Think</h4>


<pre class="wp-block-code has-small-font-size" aria-describedby="shcb-language-21" data-shcb-language-name="C++" data-shcb-language-slug="cpp"><div><code class="hljs language-cpp">time_to_think = (time_to_die - (get_time_in_ms() - philo-&gt;last_meal) - time_to_eat) / <span class="hljs-number">2</span></code></div><small class="shcb-language" id="shcb-language-21"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">C++</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">cpp</span><span class="shcb-language__paren">)</span></small></pre>


<p>Here, we are calculating the time a philosopher has before he absolutely needs to eat without starving at <code>time_to_die</code>. In order to give him enough of a margin to find his forks, we subtract the actual <code>time_to_eat</code> and divide the result by two. Let’s say that this philosopher’s last meal was at 200 ms and he slept for another 200 ms. We are now at 600 ms. The <code>time_to_die</code> is 1000 ms and the <code>time_to_eat</code> is 200 ms:</p>


<pre class="wp-block-code has-small-font-size" aria-describedby="shcb-language-22" data-shcb-language-name="PHP" data-shcb-language-slug="php"><div><code class="hljs language-php">time_to_think = (time_to_die - (get_time_in_ms() - philo-&gt;last_meal) - time_to_eat) / <span class="hljs-number">2</span>
              = (   <span class="hljs-number">1000</span>     - (       <span class="hljs-number">600</span>       -       <span class="hljs-number">200</span>       ) -     <span class="hljs-number">200</span>    ) / <span class="hljs-number">2</span>
              = ( <span class="hljs-number">1000</span> - <span class="hljs-number">400</span> - <span class="hljs-number">200</span> ) / <span class="hljs-number">2</span>
              = ( <span class="hljs-number">600</span> - <span class="hljs-number">200</span> ) / <span class="hljs-number">2</span>
              = <span class="hljs-number">400</span> / <span class="hljs-number">2</span>
              = <span class="hljs-number">200</span></code></div><small class="shcb-language" id="shcb-language-22"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">PHP</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">php</span><span class="shcb-language__paren">)</span></small></pre>


<p>We’ve determined here that the philosopher will die if he doesn’t eat in the next 600 ms. We give him a margin of <code>time_to_eat</code>, meaning we consider that he needs to eat within the next 400 ms maximum. Then, we divide this time by two to give him a safe 200 ms time to think. This way, he will have enough time to find his forks and eat, all the while giving his neighbors a chance to eat first.</p>



<p>If this result is negative, the philosopher will of course need to try to eat right away, so his time to think should be set back to 0. We’ll also want to test the case where the time to think is very long. If <code>time_to_die</code> is 10,000 ms and <code>time_to_eat</code> is 10 ms, we won’t want to wait 4,900 milliseconds or so before trying to find forks. That would be much too long of a delay before printing a status message to the screen if all the philosophers were thinking at the same time. To avoid this, we can simply limit the time to think to 500 or 600 ms maximum.</p>



<h3><span class="ez-toc-section" id="the_case_of_the_lone_philosopher"></span>The Case of the Lone Philosopher<span class="ez-toc-section-end"></span></h3>



<p>A lone philosopher must take his one and only fork and die at <code>time_to_die</code> milliseconds because he has no second fork to be able to eat. This particular case might very well create a self-deadlock if we tell the philosopher that his second fork is the same one as his first. The thread will stay suspended indefinitely, waiting for a mutex that it already owns.</p>



<p>The simplest solution to this problem is probably to modify the philosopher thread routine if it is the only one present at the table. We can write a simple function for it that only picks up one fork, waits <code>time_to_die</code> ms and immediately dies.</p>



<p>Of course, if we are using the “setting the fork back on the table” method described earlier, the philosopher thread will not encounter a deadlock since he will be juggling with his fork until the supervisor thread notices he has not eaten by <code>time_to_die</code>.</p>



<h2><span class="ez-toc-section" id="tips_for_testing_the_philosophers_project"></span>Tips for Testing the Philosophers Project<span class="ez-toc-section-end"></span></h2>



<p>The most important thing to remember when testing our philosophers project or any other program that makes use of threads, is to test the same thing many times in a row. Oftentimes, synchronization errors won’t be apparent on the first or second or even third run. It depends on the order the operating system chooses for the execution of each thread. By running the same test over and over, we may see a large variation in the results. For example:</p>



<ul><li>if a philosopher dies one time out of six when running the program with the exact same arguments, there must be a problem either with the order in which philosophers take the forks, or in the system that detects a philosopher’s death.</li><li>if, one time out of ten with the same arguments. our program stays stuck indefinitely, then there is a possible deadlock that did not occur in the previous tests.</li></ul>



<p>Our goal, on top of keeping philosophers alive, is of course to avoid these types of synchronization errors. We need to rigorously test our code, with the same arguments over and over, to ensure we get coherent results and don’t miss hidden errors.</p>



<h3><span class="ez-toc-section" id="tools_to_test_the_philosophers_project"></span>Tools to Test the Philosophers Project<span class="ez-toc-section-end"></span></h3>



<p>There are some tools we can use to help us detect thread-related errors like possible data races, deadlocks and lock order violations:</p>



<ul><li>The <code><strong>-fsanitize=thread -g</strong></code> flag we can add when compiling with gcc. The <code>-g</code> option displays the specific files and line numbers involved.</li><li>The thread error detection tool Helgrind that we can run our program with, like this: <code><strong>valgrind --tool=helgrind ./philo &lt;args&gt;</strong></code>.</li><li>DRD, another thread error detection tool that we can also run our program with, like this: <code><strong>valgrind --tool=drd ./philo &lt;args&gt;</strong></code>.</li></ul>



<p>Of course, these tools, in particular those of Valgrind, slow our simulation down and often provoke premature deaths among the philosophers…</p>



<p>And as always, we can’t forget to check for memory leaks with <code><strong>-fsanitize=address</strong></code> and <code><strong>valgrind</strong></code>!</p>



<h3><span class="ez-toc-section" id="tests_and_expected_results_for_the_philosophers_project"></span>Tests and Expected Results for the Philosophers Project<span class="ez-toc-section-end"></span></h3>



<p>The expected results of the following tests are only presented here as an aid to the development of the philosopher project. They don’t come from the official evaluation grid, which means they are open to interpretation. Other ways of reasoning may be accepted during evaluation if they are well thought out and explained.</p>



<p>Another important aspect of the project is that<strong> the death of a philosopher must be displayed within 10 ms</strong> of the event. This means that when the expected result of a test below says “a philosopher dies at 200 ms”, displaying the death message at 203 ms is acceptable, whereas displaying it at 211 ms is not.</p>



<p>The mandatory arguments of philosophers are shown in bold in the following table for clarity’s sake. As a reminder, the arguments of the program are as follows:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-23" data-shcb-language-name="plaintext" data-shcb-language-slug="plaintext"><div><code class="hljs language-plaintext">./philo &lt;arg1&gt; &lt;arg2&gt; &lt;arg3&gt; &lt;arg4&gt; [arg5]
        - arg1 = number_of_philosophers
        - arg2 = time_to_die
        - arg3 = time_to_eat
        - arg4 = time_to_sleep
        - arg5 = (optional) number_of_times_each_philosopher_must_eat</code></div><small class="shcb-language" id="shcb-language-23"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">plaintext</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">plaintext</span><span class="shcb-language__paren">)</span></small></pre>


<figure class="wp-block-table"><table class="has-fixed-layout"><tbody><tr><td><strong>Test</strong></td><td><strong>Expected Result</strong></td></tr><tr><td><code>./philo</code><br><code>./philo <strong>1</strong></code><br><code>./philo <strong>1 2</strong></code><br><code>./philo <strong>1 2 3</strong></code></td><td>Invalid argument / usage message.</td></tr><tr><td><code>./philo <strong>4 500 abc 200</strong></code></td><td>Invalid argument.</td></tr><tr><td><code>./philo <strong>4 500 200 2.9</strong></code></td><td>Invalid argument.</td></tr><tr><td><code>./philo <strong>4 -500 200 200</strong></code></td><td>Invalid argument.</td></tr><tr><td><code>./philo <strong>4 2147483648 200 200</strong></code></td><td>Invalid argument.</td></tr><tr><td><code>./philo <strong>0 800 200 200</strong></code></td><td>Invalid argument.</td></tr><tr><td><code>./philo <strong>500 100 200 200</strong></code></td><td>2 defensible solutions:<br>– Invalid argument. (ex. Max 200 philosophers)<br>– A philosopher dies at 100 ms.</td></tr><tr><td><code>./philo <strong>4 2147483647 200 200</strong></code></td><td>No one dies.</td></tr><tr><td><code>./philo <strong>4 200 2147483647 200</strong></code></td><td>A philosopher dies at 200 ms.</td></tr><tr><td><code>./philo <strong>4 800 200 2147483647</strong></code></td><td>A philosopher dies at 800 ms.</td></tr><tr><td><code>./philo <strong>2 800 200 200</strong></code></td><td>No one dies.</td></tr><tr><td><code>./philo <strong>5 800 200 200</strong></code></td><td>No one dies.</td></tr><tr><td><code>./philo <strong>5 0 200 200</strong></code></td><td>A philosopher dies at 0 ms.</td></tr><tr><td><code>./philo <strong>5 800 0 200</strong></code></td><td>No one dies.</td></tr><tr><td><code>./philo <strong>5 800 200 0</strong></code></td><td>No one dies.</td></tr><tr><td><code>./philo <strong>5 800 0 0</strong></code></td><td>No one dies.</td></tr><tr><td><code>./philo <strong>5 800 200 200</strong> 0</code></td><td>2 defensible solutions:<br>– Invalid argument.<br>– Simulation stops immediately because everyone ate 0 times.</td></tr><tr><td><code>./philo <strong>4 410 200 200</strong></code></td><td>No one dies.</td></tr><tr><td><code>./philo <strong>1 200 200 200</strong></code></td><td>Philosopher 1 takes a fork and dies at 200 ms.</td></tr><tr><td><code>./philo <strong>4 2147483647 0 0</strong></code></td><td>No one dies.</td></tr><tr><td><code>./philo <strong>4 200 210 200</strong></code></td><td>A philosopher dies at 200 ms.</td></tr><tr><td><code>./philo <strong>2 600 200 800</strong></code></td><td>A philosopher dies at 600 ms.</td></tr><tr><td><code>./philo <strong>4 310 200 200</strong></code></td><td>A philosopher dies at 310 ms.</td></tr><tr><td><code>./philo <strong>3 400 100 100</strong> 3</code></td><td>No one dies, each philosopher eats at least 3 times.</td></tr><tr><td><code>./philo <strong>200 800 200 200</strong> 9</code></td><td>No one dies, each philosopher eats at least 9 times.</td></tr><tr><td><code>./philo <strong>200 410 200 200</strong></code></td><td>A philosopher dies at 410 ms.</td></tr></tbody></table></figure>



<h2><span class="ez-toc-section" id="completed_code_for_the_philosophers_project"></span>Completed Code for the Philosophers Project<span class="ez-toc-section-end"></span></h2>



<p>My complete philosophers code is available&nbsp;<a href="https://web.archive.org/web/20220718211836/https://github.com/mcombeau/philosophers">over here, on GitHub</a>. If you are a 42 student, I encourage you to use the elements above to build your own code in your own way, before glancing at mine.</p>



<p>Please leave a comment if you’ve found another solution or other ways to test philosophers!</p>



<h2><span class="ez-toc-section" id="sources_and_further_reading"></span>Sources and Further Reading<span class="ez-toc-section-end"></span></h2>



<ul><li>Bryant, R., O’Hallaron, D., 2016, <em>Computer Systems: a Programmer’s Perspective</em>, Chapter 12: Concurrent Programming, p. 1007 – 1076</li><li>Arpaci-Dusseau R., Arpaci-Dusseau, A., 2018, <em>Operating Systems: Three Easy Pieces</em>, Part II: Concurrency [<a href="https://web.archive.org/web/20220718211836/https://pages.cs.wisc.edu/~remzi/OSTEP/">OSTEP</a>]</li><li>Wikipedia, <em>Dining philosophers problem</em> [<a href="https://web.archive.org/web/20220718211836/https://en.wikipedia.org/wiki/Dining_philosophers_problem">Wikipedia</a>]</li><li>Wikipedia, <em>Concurrent computing</em> [<a href="https://web.archive.org/web/20220718211836/https://en.wikipedia.org/wiki/Concurrent_computing">Wikipedia</a>]</li><li>Wikipedia, <em>Mutual exclusion</em> [<a href="https://web.archive.org/web/20220718211836/https://en.wikipedia.org/wiki/Mutual_exclusion">Wikipedia</a>]</li><li>Stackoverflow, <em>Why is 1/1/1970 the “epoch time” ?</em> [<a href="https://web.archive.org/web/20220718211836/https://stackoverflow.com/questions/1090869/why-is-1-1-1970-the-epoch-time">Stackoverflow</a>]</li><li>The Linux Programmer Manual:<ul><li><em>pthread_create(3)</em> [<a href="https://web.archive.org/web/20220718211836/https://linux.die.net/man/3/pthread_create">man</a>]</li><li><em>pthread_join(3)</em> [<a href="https://web.archive.org/web/20220718211836/https://linux.die.net/man/3/pthread_join">man</a>]</li><li><em>pthread_detach(3)</em> [<a href="https://web.archive.org/web/20220718211836/https://linux.die.net/man/3/pthread_detach">man</a>]</li><li><em>pthread_mutex_init/lock/unlock(3)</em> [<a href="https://web.archive.org/web/20220718211836/https://linux.die.net/man/3/pthread_mutex_init">man</a>]</li><li><em>gettimeofday(2)</em> [<a href="https://web.archive.org/web/20220718211836/https://linux.die.net/man/2/gettimeofday">man</a>]</li></ul></li></ul>



<ul><li>Valgrind User Manual, <em>Helgrind: a thread error detector</em> [<a href="https://web.archive.org/web/20220718211836/https://cs.swan.ac.uk/~csoliver/ok-sat-library/internet_html/doc/doc/Valgrind/3.8.1/html/hg-manual.html">cs.swan.ac.uk</a>]</li><li>Valgrind User Manual, <em>DRD: a thread error detector</em> [<a href="https://web.archive.org/web/20220718211836/https://valgrind.org/docs/manual/drd-manual.html">valgrind.org</a>]</li><li>Spaghetti vector graphic by <a href="https://web.archive.org/web/20220718211836/https://www.vecteezy.com/free-vector/vector">Vecteezy</a>.</li></ul>

                        
                            <div class="entry-tags"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/tag/42-cursus/" rel="tag">42 cursus</a> <a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/tag/c-en/" rel="tag">C</a> <a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/tag/concurrency/" rel="tag">concurrency</a> <a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/tag/data-race-en/" rel="tag">data race</a> <a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/tag/deadlock-en/" rel="tag">deadlock</a> <a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/tag/mutex-en/" rel="tag">mutex</a> <a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/tag/thread-en/" rel="tag">thread</a></div>
            
        </div>
        
                             
    </article>
</div>
				
	<div class="section-head"><h3 class="section-title h6">About the author</h3></div>	
	
		<div class="section-content typology-author">
				
			<div class="container">

				<div class="col-lg-2">
									</div>

				<div class="col-lg-10">

					<h5 class="typology-author-box-title">Mia Combeau</h5>
					<div class="typology-author-desc">
						<p>Student at 42Paris, digital world explorer. I code to the 42 school norm, which means for loops, switches, ternary operators and all kinds of other things are out of reach... for now!</p>
					</div>

					<div class="typology-author-links">
						<a class="typology-button-social hover-on" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/author/mcombeau/">View all posts</a><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/" target="_blank" rel="noopener" class="typology-icon-social hover-on fa fa-link"></a>					</div>

				</div>

			</div>

		</div>

			


				
	
				
		<div class="section-head"><h3 class="section-title h6">Add comment</h3></div>
		<div id="comments" class="section-content typology-comments">

				<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate=""><p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required" aria-hidden="true">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required=""></p>
<p class="comment-form-email"><label for="email">Email <span class="required" aria-hidden="true">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" required=""></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="3448" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p></form>	</div><!-- #respond -->
				
			

		</div>

		<div class="typology-pagination typology-comments-pagination">
					</div>

				
							</div>

		
	
	
		<div class="typology-section typology-section-related">

			<div class="section-head"><h3 class="section-title h6">Read more</h3></div>
			
			<div class="section-content section-content-c">

				<div class="typology-posts">

											<article class="typology-post typology-layout-c col-lg-6 text-center post-image-off post-2805 post type-post status-publish format-standard has-post-thumbnail hentry category-computer-science tag-computer tag-console-en tag-operating-system tag-shell-en tag-terminal-en">

            
    <header class="entry-header">
        <h2 class="entry-title h4"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/difference-between-terminal-console-and-shell/">The Difference Between a Terminal, a Console and a Shell</a></h2>         
            <div class="entry-meta"><div class="meta-item meta-date"><span class="updated">June 26, 2022</span></div></div>
                            <div class="post-letter">T</div>
            </header>

</article>											<article class="typology-post typology-layout-c col-lg-6 text-center post-image-off post-2729 post type-post status-publish format-standard has-post-thumbnail hentry category-42-school-projects tag-42-cursus tag-algorithm tag-c-en tag-sorting-algorithm tag-walkthrough">

            
    <header class="entry-header">
        <h2 class="entry-title h4"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/push_swap-efficient-positional-sorting-algorithm/">Push_Swap: an Efficient Positional Sorting Algorithm</a></h2>         
            <div class="entry-meta"><div class="meta-item meta-date"><span class="updated">June 24, 2022</span></div></div>
                            <div class="post-letter">P</div>
            </header>

</article>											<article class="typology-post typology-layout-c col-lg-6 text-center post-image-off post-2588 post type-post status-publish format-standard has-post-thumbnail hentry category-methodology category-programming-tools tag-developer tag-methodology tag-writing">

            
    <header class="entry-header">
        <h2 class="entry-title h4"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/why-a-blog-is-a-great-developer-tool/">Why a Blog is a Great Developer Tool</a></h2>         
            <div class="entry-meta"><div class="meta-item meta-date"><span class="updated">June 20, 2022</span></div></div>
                            <div class="post-letter">W</div>
            </header>

</article>											<article class="typology-post typology-layout-c col-lg-6 text-center post-image-off post-2548 post type-post status-publish format-standard has-post-thumbnail hentry category-c-programming tag-c-en tag-global-variable tag-local-variable tag-memory tag-memory-allocation tag-stack-en tag-static-en tag-static-variable tag-variables">

            
    <header class="entry-header">
        <h2 class="entry-title h4"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/local-global-static-variables-in-c/">Local, Global and Static Variables in C</a></h2>         
            <div class="entry-meta"><div class="meta-item meta-date"><span class="updated">June 17, 2022</span></div></div>
                            <div class="post-letter">L</div>
            </header>

</article>									
				</div>
			</div>
		
		</div>

	
	

	

	<div id="typology-single-sticky" class="typology-single-sticky">
		
		<div class="typology-sticky-content meta">
			
<div class="typology-flex-center">
	<div class="typology-sticky-author typology-sticky-l">

		
						<span class="sticky-author-title">
				<a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/author/mcombeau/">By Mia Combeau</a>
				<span class="sticky-author-date">July 18, 2022</span>
			</span>

			</div>

	<div class="typology-sticky-c">
		
	</div>

	<a href="javascript: void(0);" class="typology-sticky-to-top typology-sticky-c">
			<span class="typology-top-ico"><i class="fa fa-chevron-up"></i></span>
			<span class="typology-top-link">To Top</span>
	</a>

</div>
		</div>

		<div class="typology-sticky-content prev-next">
			<nav class="typology-prev-next-nav typology-flex-center">
	
	
<div class="typology-prev-link typology-sticky-l">	
	</div>
	
	<a href="javascript: void(0);" class="typology-sticky-to-top typology-sticky-c">
			<span class="typology-top-ico"><i class="fa fa-chevron-up"></i></span>
			<span class="typology-top-link">To Top</span>
	</a>

<div class="typology-next-link typology-sticky-r">	
		
			<a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/push_swap-efficient-positional-sorting-algorithm/">
				<span class="typology-pn-ico"><i class="fa fa-chevron-right"></i></span>
				<span class="typology-pn-link">Push_Swap: an Efficient Positional Sorting Algorithm</span>
			</a>
			</div>
</nav>

		</div>
	</div>

                            <footer id="typology-footer" class="typology-footer">
                    
                                        
                                            
                        <div class="container">
                                    
                                                                    <div class="col-lg-4 typology-footer-sidebar"><div id="nav_menu-2" class="widget clearfix widget_nav_menu"><h4 class="widget-title h5">Menu</h4><div class="menu-footer-menu-english-container"><ul id="menu-footer-menu-english" class="menu"><li id="menu-item-979" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-979"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/legal-notice/">Legal Notice</a></li>
<li id="menu-item-922" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-922"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/contact-en/">Contact</a></li>
</ul></div></div></div>
                                                                    
                                                                    <div class="col-lg-4 typology-footer-sidebar"><div id="categories-4" class="widget clearfix widget_categories"><h4 class="widget-title h5">Categories</h4>
			<ul>
					<li class="cat-item cat-item-124"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/42-school-projects/">42 School Projects</a>
</li>
	<li class="cat-item cat-item-128"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/c-programming/">C Programming</a>
</li>
	<li class="cat-item cat-item-116"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/computer-science/">Computer Science</a>
</li>
	<li class="cat-item cat-item-364"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/methodology/">Methodology</a>
</li>
	<li class="cat-item cat-item-120"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/programming-tools/">Programming Tools</a>
</li>
			</ul>

			</div></div>
                                                                    
                                                                    <div class="col-lg-4 typology-footer-sidebar"><div id="custom_html-3" class="widget_text widget clearfix widget_custom_html"><div class="textwidget custom-html-widget"><a rel="license" href="https://web.archive.org/web/20220718211836/http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" data-src="https://web.archive.org/web/20220718211836/https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" class="lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img alt="Creative Commons License" style="border-width:0" src="https://web.archive.org/web/20220718211836im_/https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"/></noscript></a><br>This work is licensed under a <a rel="license" href="https://web.archive.org/web/20220718211836/http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</div></div></div>
                                                                    
                        </div>

                                    </footer>
            
            
		</div>

		<div class="typology-sidebar">
	<div class="typology-sidebar-header">
		<div class="typology-sidebar-header-wrapper">
			<div class="typology-site-branding">
	
	<span class="site-title h4"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/" rel="home"><img alt="codequoi" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/codequoi-logo-200x71-1.png" class="typology-logo lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img alt="codequoi" data-src="https://web.archive.org/web/20220718211836/https://www.codequoi.com/wp-content/uploads/2022/07/codequoi-logo-200x71-1.png" class="typology-logo lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img class="typology-logo" src="https://web.archive.org/web/20220718211836im_/https://www.codequoi.com/wp-content/uploads/2022/07/codequoi-logo-200x71-1.png" alt="codequoi"></noscript></a></span>	
</div>
			<span class="typology-sidebar-close"><i class="fa fa-times" aria-hidden="true"></i></span>
		</div>
	</div>

	<div class="widget typology-responsive-menu">
					<ul id="menu-main-menu-english-1" class="typology-nav typology-main-navigation"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-584"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/home-english/">Home</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-1028"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/philosophers-01-threads-and-mutexes/#">Categories</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1029"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/42-school-projects/">42 School Projects</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1030"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/c-programming/">C Programming</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1031"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/computer-science/">Computer Science</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3419"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/methodology/">Methodology</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1032"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/category/programming-tools/">Programming Tools</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-933"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-601"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/en/contact-en/">Contact</a></li>
<li class="lang-item lang-item-19 lang-item-fr lang-item-first menu-item menu-item-type-custom menu-item-object-custom menu-item-583-fr"><a href="https://web.archive.org/web/20220718211836/https://www.codequoi.com/philosophers-01-threads-et-mutex/" hreflang="fr-FR" lang="fr-FR"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAMAAABBPP0LAAAAbFBMVEVzldTg4ODS0tLxDwDtAwDjAADD0uz39/fy8vL3k4nzgna4yOixwuXu7u7s6+zn5+fyd2rvcGPtZljYAABrjNCpvOHrWkxegsqfs93NAADpUUFRd8THAABBa7wnVbERRKa8vLyxsLCoqKigoKClCvcsAAAAXklEQVR4AS3JxUEAQQAEwZo13Mk/R9w5/7UERJCIGIgj5qfRJZEpPyNfCgJTjMR1eRRnJiExFJz5Mf1PokWr/UztIjRGQ3V486u0HO55m634U6dMcf0RNPfkVCTvKjO16xHA8miowAAAAABJRU5ErkJggg==" alt="Français" width="16" height="11" style="width: 16px; height: 11px;"></a></li>
</ul>		</div>

	
</div>

<div class="typology-sidebar-overlay"></div>		
		<!-- Matomo --><script type="text/javascript">
var _paq = window._paq = window._paq || [];
_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);_paq.push(['alwaysUseSendBeacon']);_paq.push(['setTrackerUrl', "\/\/web.archive.org\/web\/20220718211836\/https:\/\/www.codequoi.com\/wp-content\/plugins\/matomo\/app\/matomo.php"]);_paq.push(['setSiteId', '1']);var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
g.type='text/javascript'; g.async=true; g.src="\/\/web.archive.org\/web\/20220718211836\/https:\/\/www.codequoi.com\/wp-content\/uploads\/matomo\/matomo.js"; s.parentNode.insertBefore(g,s);
</script>
<!-- End Matomo Code --><script type="text/javascript" src="./Philosophers 01_ Threads and Mutexes - codequoi_files/ab7c1f7bf1cb139259684eedcabeb956.js" id="mks_shortcodes_js-js"></script>
<script type="text/javascript" src="./Philosophers 01_ Threads and Mutexes - codequoi_files/24baf7f4e127f7bfa2a95c447e937877.js" id="wphb-5-js"></script>
<script type="text/javascript" id="wphb-6-js-extra">
/* <![CDATA[ */
var ezTOC = {"smooth_scroll":"1","visibility_hide_by_default":"","width":"100%","scroll_offset":"30"};;;var typology_js_settings = {"rtl_mode":"","header_sticky":"1","logo":"https:\/\/web.archive.org\/web\/20220718211836\/https:\/\/www.codequoi.com\/wp-content\/uploads\/2022\/07\/codequoi-logo-200x71-1.png","logo_retina":"https:\/\/web.archive.org\/web\/20220718211836\/https:\/\/www.codequoi.com\/wp-content\/uploads\/2022\/05\/codequoi-logo-1.png","use_gallery":"1","slider_autoplay":"0","cover_video_image_fallback":""};
/* ]]> */
</script>
<script type="text/javascript" src="./Philosophers 01_ Threads and Mutexes - codequoi_files/4177feaa2ed1914f00b30c37936a11d6.js" id="wphb-6-js"></script>
<script type="text/javascript">
(function() {
				var expirationDate = new Date();
				expirationDate.setTime( expirationDate.getTime() + 31536000 * 1000 );
				document.cookie = "pll_language=en; expires=" + expirationDate.toUTCString() + "; path=/; secure; SameSite=Lax";
			}());
</script>

	

<!--
playback timings (ms):
  captures_list: 259.268
  exclusion.robots: 0.259
  exclusion.robots.policy: 0.249
  cdx.remote: 0.093
  esindex: 0.013
  LoadShardBlock: 110.263 (3)
  PetaboxLoader3.datanode: 74.856 (4)
  CDXLines.iter: 22.333 (3)
  load_resource: 149.74
  PetaboxLoader3.resolve: 95.987
--></body></html>